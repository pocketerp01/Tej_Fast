var Handsontable={extension:{},helper:{}};!function(t,e,o){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,o=Number(arguments[1])||0;for((o=o<0?Math.ceil(o):Math.floor(o))<0&&(o+=e);o<e;o++)if(o in this&&this[o]===t)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){if(void 0===this||null===this)throw new TypeError;if("function"!=typeof t)throw new TypeError;/NodeList/i.test((e=e||this).item)&&(e=function(t){for(var e=[],o=0,i=t.length;o<i;o++)e[o]=t[o];return e}(e));var o,i,n=e.length,s=[];for(o=0;o<n;o+=1)e.hasOwnProperty(o)&&(i=e[o],t.call(e,i,o,e)&&s.push(i));return s}),"undefined"==typeof WeakMap&&function(){var t=Object.defineProperty;try{var o=!0;t(function(){},"foo",{})}catch(t){o=!1}var i=+new Date%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+i+++"__",o||(this._wmCache=[])};n.prototype=o?{set:function(e,o){var i=e[this.name];i&&i[0]===e?i[1]=o:t(e,this.name,{value:[e,o],writable:!0})},get:function(t){var e;return(e=t[this.name])&&e[0]===t?e[1]:void 0},delete:function(t){this.set(t,void 0)}}:{set:function(t,e){if(void 0!==t&&void 0!==e){for(var o=0,i=this._wmCache.length;o<i;o++)if(this._wmCache[o].key==t)return void(this._wmCache[o].value=e);this._wmCache.push({key:t,value:e})}},get:function(t){if(void 0!==t)for(var e=0,o=this._wmCache.length;e<o;e++)if(this._wmCache[e].key==t)return this._wmCache[e].value},delete:function(t){if(void 0!==t)for(var e=0,o=this._wmCache.length;e<o;e++)this._wmCache[e].key==t&&Array.prototype.slice.call(this._wmCache,e,1)}},e.WeakMap=n}(),o.activeGuid=null,o.Core=function(i,n){var s,r,a,l,c,h,u=this,d=function(){};o.helper.extend(d.prototype,C.prototype),o.helper.extend(d.prototype,n),o.helper.extend(d.prototype,v(n)),this.rootElement=i;var p=t(document.documentElement),f=t(document.body);function g(){var t=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==t&&(t=!0,this.onQueueEmpty())}}}function m(e,o,i){var n=new g;n.onQueueEmpty=function(){var n;e.length&&("function"==typeof(n=u.PluginHooks.execute("beforeChange",e,o))?t.when(result).then(function(){i()}):!1===n&&e.splice(0,e.length));"function"!=typeof n&&i()};for(var s=e.length-1;s>=0;s--)if(null===e[s])e.splice(s,1);else{var a=e[s][0],l=r.propToCol(e[s][1]),c=u.runHooksAndReturn("modifyCol",l),h=u.getCellMeta(a,c);"numeric"===h.type&&"string"==typeof e[s][3]&&e[s][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(e[s][3])&&(e[s][3]=numeral().unformat(e[s][3]||"0")),u.getCellValidator(h)&&(n.addValidatorToQueue(),u.validateCell(e[s][3],h,function(t,o){return function(i){if("boolean"!=typeof i)throw new Error("Validation error: result is not boolean");!1===i&&!1===o.allowInvalid&&(e.splice(t,1),o.valid=!0,--t),n.removeValidatorFormQueue()}}(s,h),o))}n.checkIfQueueIsEmpty()}function w(t,e){var o=t.length-1;if(!(o<0)){for(;0<=o;o--)if(null!==t[o]){if(s.settings.minSpareRows)for(;t[o][0]>u.countRows()-1;)r.createRow();if("array"===u.dataType&&s.settings.minSpareCols)for(;r.propToCol(t[o][1])>u.countCols()-1;)r.createCol();r.set(t[o][0],t[o][1],t[o][3])}else t.splice(o,1);u.forceFullRender=!0,a.adjustRowsAndCols(),l.refreshBorders(null,!0),u.PluginHooks.run("afterChange",t,e||"edit")}}function y(e,o,i){return"object"==typeof e?e:t.isPlainObject(i)?i:[[e,o,i]]}function v(t){if(t.hasOwnProperty("type")){var e,i={};if("object"==typeof t.type)e=t.type;else if("string"==typeof t.type&&void 0===(e=o.cellTypes[t.type]))throw new Error('You declared cell type "'+t.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(i[n]=e[n]);return i}}this.guid="ht_"+o.helper.randomString(),this.rootElement[0].id||(this.rootElement[0].id=this.guid),s={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new d,settingsFromDOM:{},selStart:new o.SelectionPoint,selEnd:new o.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:!0},a={alter:function(t,e,i,n,c){var h;switch(i=i||1,t){case"insert_row":(h=r.createRow(e,i))&&(s.selStart.exists()&&s.selStart.row()>=e?(s.selStart.row(s.selStart.row()+h),l.transformEnd(h,0)):l.refreshBorders());break;case"insert_col":if(h=r.createCol(e,i)){if(o.helper.isArray(u.getSettings().colHeaders)){var d=[e,0];d.length+=h,Array.prototype.splice.apply(u.getSettings().colHeaders,d)}s.selStart.exists()&&s.selStart.col()>=e?(s.selStart.col(s.selStart.col()+h),l.transformEnd(0,h)):l.refreshBorders()}break;case"remove_row":r.removeRow(e,i),s.cellSettings.splice(e,i),a.adjustRowsAndCols(),l.refreshBorders();break;case"remove_col":r.removeCol(e,i);for(var p=0,f=r.getAll().length;p<f;p++)p in s.cellSettings&&s.cellSettings[p].splice(e,i);o.helper.isArray(u.getSettings().colHeaders)&&(void 0===e&&(e=-1),u.getSettings().colHeaders.splice(e,i)),s.columnSettings.splice(e,i),a.adjustRowsAndCols(),l.refreshBorders();break;default:throw new Error('There is no such action "'+t+'"')}c||a.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e,o,i=u.countEmptyRows(!0);if((e=u.countRows())<s.settings.minRows)for(t=0;t<s.settings.minRows-e;t++)r.createRow();if(i<s.settings.minSpareRows)for(;i<s.settings.minSpareRows&&u.countRows()<s.settings.maxRows;i++)r.createRow();if(o=u.countEmptyCols(!0),!s.settings.columns&&u.countCols()<s.settings.minCols)for(;u.countCols()<s.settings.minCols;o++)r.createCol();if(!s.settings.columns&&"array"===u.dataType&&o<s.settings.minSpareCols)for(;o<s.settings.minSpareCols&&u.countCols()<s.settings.maxCols;o++)r.createCol();if(s.settings.enterBeginsEditing)for(;(s.settings.minRows||s.settings.minSpareRows)&&u.countRows()>s.settings.minRows&&s.settings.minSpareRows&&i>s.settings.minSpareRows;i--)r.removeRow();if(s.settings.enterBeginsEditing&&!s.settings.columns)for(;(s.settings.minCols||s.settings.minSpareCols)&&u.countCols()>s.settings.minCols&&s.settings.minSpareCols&&o>s.settings.minSpareCols;o--)r.removeCol();var n=u.countRows(),a=u.countCols();if(0!==n&&0!==a||l.deselect(),s.selStart.exists()){var c,h=s.selStart.row(),d=s.selStart.col(),p=s.selEnd.row(),f=s.selEnd.col();h>n-1?(c=!0,p>(h=n-1)&&(p=h)):p>n-1&&(c=!0,h>(p=n-1)&&(h=p)),d>a-1?(c=!0,f>(d=a-1)&&(f=d)):f>a-1&&(c=!0,d>(f=a-1)&&(d=f)),c&&u.selectCell(h,d,p,f)}},populateFromArray:function(t,e,i,n,r){var a,l,c,h,d,p,f,g,m=[],w={};if(0===(l=e.length))return!1;switch(r){case"shift_down":for(d=i?i.col-t.col+1:0,p=i?i.row-t.row+1:0,c=0,h=(e=o.helper.translateRowsToColumns(e)).length,f=Math.max(h,d);c<f;c++)if(c<h){for(a=0,l=e[c].length;a<p-l;a++)e[c].push(e[c][a%l]);e[c].unshift(t.col+c,t.row,0),u.spliceCol.apply(u,e[c])}else e[c%h][0]=t.col+c,u.spliceCol.apply(u,e[c%h]);break;case"shift_right":for(d=i?i.col-t.col+1:0,p=i?i.row-t.row+1:0,a=0,l=e.length,g=Math.max(l,p);a<g;a++)if(a<l){for(c=0,h=e[a].length;c<d-h;c++)e[a].push(e[a][c%h]);e[a].unshift(t.row+a,t.col,0),u.spliceRow.apply(u,e[a])}else e[a%l][0]=t.row+a,u.spliceRow.apply(u,e[a%l]);break;case"overwrite":default:for(w.row=t.row,w.col=t.col,a=0;a<l&&!(i&&w.row>i.row||!s.settings.minSpareRows&&w.row>u.countRows()-1||w.row>=s.settings.maxRows);a++){for(w.col=t.col,h=e[a]?e[a].length:0,c=0;c<h&&!(i&&w.col>i.col||!s.settings.minSpareCols&&w.col>u.countCols()-1||w.col>=s.settings.maxCols);c++)u.getCellMeta(w.row,w.col).readOnly||m.push([w.row,w.col,e[a][c]]),w.col++,i&&c===h-1&&(c=-1);w.row++,i&&a===l-1&&(a=-1)}u.setDataAtCell(m,null,null,n||"populateFromArray")}},getCornerCoords:function(e){function o(e,o,i){function n(t){return t[i]}return Array.prototype.map?e.apply(Math,o.map(n)):e.apply(Math,t.map(o,n))}return{TL:{row:o(Math.min,e,"row"),col:o(Math.min,e,"col")},BR:{row:o(Math.max,e,"row"),col:o(Math.max,e,"col")}}},getCellsAtCoords:function(t,e){var o,i,n=a.getCornerCoords([t,e]),s=[];for(o=n.TL.row;o<=n.BR.row;o++)for(i=n.TL.col;i<=n.BR.col;i++)s.push(u.view.getCellAtCoords({row:o,col:i}));return s}},this.selection=l={inProgress:!1,begin:function(){u.selection.inProgress=!0},finish:function(){var t=u.getSelected();u.PluginHooks.run("afterSelectionEnd",t[0],t[1],t[2],t[3]),u.PluginHooks.run("afterSelectionEndByProp",t[0],u.colToProp(t[1]),t[2],u.colToProp(t[3])),u.selection.inProgress=!1},isInProgress:function(){return u.selection.inProgress},setRangeStart:function(t){s.selStart.coords(t),l.setRangeEnd(t)},setRangeEnd:function(t,e){u.selection.begin(),s.selEnd.coords(t),s.settings.multiSelect||s.selStart.coords(t),u.view.wt.selections.current.clear(),u.view.wt.selections.current.add(s.selStart.arr()),u.view.wt.selections.area.clear(),l.isMultiple()&&(u.view.wt.selections.area.add(s.selStart.arr()),u.view.wt.selections.area.add(s.selEnd.arr())),(s.settings.currentRowClassName||s.settings.currentColClassName)&&(u.view.wt.selections.highlight.clear(),u.view.wt.selections.highlight.add(s.selStart.arr()),u.view.wt.selections.highlight.add(s.selEnd.arr())),u.PluginHooks.run("afterSelection",s.selStart.row(),s.selStart.col(),s.selEnd.row(),s.selEnd.col()),u.PluginHooks.run("afterSelectionByProp",s.selStart.row(),r.colToProp(s.selStart.col()),s.selEnd.row(),r.colToProp(s.selEnd.col())),!1!==e&&u.view.scrollViewport(t),l.refreshBorders()},refreshBorders:function(t,e){e||c.destroyEditor(t),u.view.render(),l.isSelected()&&!e&&c.prepareEditor()},isMultiple:function(){return!(s.selEnd.col()===s.selStart.col()&&s.selEnd.row()===s.selStart.row())},transformStart:function(t,e,o){s.selStart.row()+t>u.countRows()-1?o&&s.settings.minSpareRows>0?u.alter("insert_row",u.countRows()):s.settings.autoWrapCol&&(t=1-u.countRows(),e=s.selStart.col()+e==u.countCols()-1?1-u.countCols():1):s.settings.autoWrapCol&&s.selStart.row()+t<0&&s.selStart.col()+e>=0&&(t=u.countRows()-1,e=s.selStart.col()+e==0?u.countCols()-1:-1),s.selStart.col()+e>u.countCols()-1?o&&s.settings.minSpareCols>0?u.alter("insert_col",u.countCols()):s.settings.autoWrapRow&&(t=s.selStart.row()+t==u.countRows()-1?1-u.countRows():1,e=1-u.countCols()):s.settings.autoWrapRow&&s.selStart.col()+e<0&&s.selStart.row()+t>=0&&(t=s.selStart.row()+t==0?u.countRows()-1:-1,e=u.countCols()-1);var i=u.countRows(),n=u.countCols(),r={row:s.selStart.row()+t,col:s.selStart.col()+e};r.row<0?r.row=0:r.row>0&&r.row>=i&&(r.row=i-1),r.col<0?r.col=0:r.col>0&&r.col>=n&&(r.col=n-1),l.setRangeStart(r)},transformEnd:function(t,e){if(s.selEnd.exists()){var o=u.countRows(),i=u.countCols(),n={row:s.selEnd.row()+t,col:s.selEnd.col()+e};n.row<0?n.row=0:n.row>0&&n.row>=o&&(n.row=o-1),n.col<0?n.col=0:n.col>0&&n.col>=i&&(n.col=i-1),l.setRangeEnd(n)}},isSelected:function(){return s.selEnd.exists()},inInSelection:function(t){if(!l.isSelected())return!1;var e=a.getCornerCoords([s.selStart.coords(),s.selEnd.coords()]);return e.TL.row<=t.row&&e.BR.row>=t.row&&e.TL.col<=t.col&&e.BR.col>=t.col},deselect:function(){l.isSelected()&&(u.selection.inProgress=!1,s.selEnd=new o.SelectionPoint,u.view.wt.selections.current.clear(),u.view.wt.selections.area.clear(),c.destroyEditor(),l.refreshBorders(),u.PluginHooks.run("afterDeselect"))},selectAll:function(){s.settings.multiSelect&&(l.setRangeStart({row:0,col:0}),l.setRangeEnd({row:u.countRows()-1,col:u.countCols()-1},!1))},empty:function(){if(l.isSelected()){var t,e,o=a.getCornerCoords([s.selStart.coords(),s.selEnd.coords()]),i=[];for(t=o.TL.row;t<=o.BR.row;t++)for(e=o.TL.col;e<=o.BR.col;e++)u.getCellMeta(t,e).readOnly||i.push([t,e,""]);u.setDataAtCell(i)}}},this.autofill=h={handle:null,init:function(){h.handle?h.handle.disabled=!1:h.handle={}},disable:function(){h.handle.disabled=!0},selectAdjacent:function(){var t,e,o,i,n;t=l.isMultiple()?u.view.wt.selections.area.getCorners():u.view.wt.selections.current.getCorners(),e=r.getAll();t:for(o=t[2]+1;o<u.countRows();o++){for(n=t[1];n<=t[3];n++)if(e[o][n])break t;(e[o][t[1]-1]||e[o][t[3]+1])&&(i=o)}i&&(u.view.wt.selections.fill.clear(),u.view.wt.selections.fill.add([t[0],t[1]]),u.view.wt.selections.fill.add([i,t[3]]),h.apply())},apply:function(){var t,e,o,i,n;h.handle.isDragged=0,(t=u.view.wt.selections.fill.getCorners())&&(u.view.wt.selections.fill.clear(),e=l.isMultiple()?u.view.wt.selections.area.getCorners():u.view.wt.selections.current.getCorners(),t[0]===e[0]&&t[1]<e[1]?(o={row:t[0],col:t[1]},i={row:t[2],col:e[1]-1}):t[0]===e[0]&&t[3]>e[3]?(o={row:t[0],col:e[3]+1},i={row:t[2],col:t[3]}):t[0]<e[0]&&t[1]===e[1]?(o={row:t[0],col:t[1]},i={row:e[0]-1,col:t[3]}):t[2]>e[2]&&t[1]===e[1]&&(o={row:e[2]+1,col:t[1]},i={row:t[2],col:t[3]}),o&&(n=SheetClip.parse(r.getText(s.selStart.coords(),s.selEnd.coords())),u.PluginHooks.run("beforeAutofill",o,i,n),a.populateFromArray(o,n,i,"autofill"),l.setRangeStart({row:t[0],col:t[1]}),l.setRangeEnd({row:t[2],col:t[3]})))},showBorder:function(t){t.row=t[0],t.col=t[1];var e=a.getCornerCoords([s.selStart.coords(),s.selEnd.coords()]);if("horizontal"!==s.settings.fillHandle&&(e.BR.row<t.row||e.TL.row>t.row))t=[t.row,e.BR.col];else{if("vertical"===s.settings.fillHandle)return;t=[e.BR.row,t.col]}u.view.wt.selections.fill.clear(),u.view.wt.selections.fill.add([s.selStart.coords().row,s.selStart.coords().col]),u.view.wt.selections.fill.add([s.selEnd.coords().row,s.selEnd.coords().col]),u.view.wt.selections.fill.add(t),u.view.render()}},this.init=function(){u.PluginHooks.run("beforeInit"),this.view=new o.TableView(this),c=new o.EditorManager(u,s,l,r),this.updateSettings(s.settings,!0),this.parseSettingsFromDOM(),this.forceFullRender=!0,this.view.render(),"object"==typeof s.firstRun&&(u.PluginHooks.run("afterChange",s.firstRun[0],s.firstRun[1]),s.firstRun=!1),u.PluginHooks.run("afterInit")},this.validateCell=function(t,e,o,i){var n,s=u.getCellValidator(e);"[object RegExp]"===Object.prototype.toString.call(s)&&(n=s,s=function(t,e){e(n.test(t))}),"function"==typeof s?(t=u.PluginHooks.execute("beforeValidate",t,e.row,e.prop,i),setTimeout(function(){s.call(e,t,function(n){e.valid=n,n=u.PluginHooks.execute("afterValidate",n,t,e.row,e.prop,i),o(n)})})):(e.valid=!0,o(!0))},this.setDataAtCell=function(t,e,o,i){var n,s,a,l=y(t,e,o),c=[];for(n=0,s=l.length;n<s;n++){if("object"!=typeof l[n])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof l[n][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");a=r.colToProp(l[n][1]),c.push([l[n][0],a,r.get(l[n][0],a),l[n][2]])}i||"object"!=typeof t||(i=e),m(c,i,function(){w(c,i)})},this.setDataAtRowProp=function(t,e,o,i){var n,s,a=y(t,e,o),l=[];for(n=0,s=a.length;n<s;n++)l.push([a[n][0],a[n][1],r.get(a[n][0],a[n][1]),a[n][2]]);i||"object"!=typeof t||(i=e),m(l,i,function(){w(l,i)})},this.listen=function(){o.activeGuid=u.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){o.activeGuid=null},this.isListening=function(){return o.activeGuid===u.guid},this.destroyEditor=function(t){l.refreshBorders(t)},this.populateFromArray=function(t,e,o,i,n,s,r){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return a.populateFromArray({row:t,col:e},o,"number"==typeof i?{row:i,col:n}:null,s,r)},this.spliceCol=function(t,e,o){return r.spliceCol.apply(r,arguments)},this.spliceRow=function(t,e,o){return r.spliceRow.apply(r,arguments)},this.getCornerCoords=function(t){return a.getCornerCoords(t)},this.getSelected=function(){if(l.isSelected())return[s.selStart.row(),s.selStart.col(),s.selEnd.row(),s.selEnd.col()]},this.parseSettingsFromDOM=function(){var t=this.rootElement.css("overflow");if("scroll"===t||"auto"===t?(this.rootElement[0].style.overflow="visible",s.settingsFromDOM.overflow=t):void 0!==s.settings.width&&void 0!==s.settings.height||(s.settingsFromDOM.overflow="auto"),void 0===s.settings.width?s.settingsFromDOM.width=this.rootElement.width():s.settingsFromDOM.width=void 0,s.settingsFromDOM.height=void 0,void 0===s.settings.height&&("scroll"===s.settingsFromDOM.overflow||"auto"===s.settingsFromDOM.overflow)){var o=this.rootElement[0].cloneNode(!1),i=this.rootElement[0].parentNode;if(i){o.removeAttribute("id"),i.appendChild(o);var n=parseInt(e.getComputedStyle(o,null).getPropertyValue("height"),10);isNaN(n)&&o.currentStyle&&(n=parseInt(o.currentStyle.height,10)),n>0&&(s.settingsFromDOM.height=n),i.removeChild(o)}}},this.render=function(){u.view&&(u.forceFullRender=!0,u.parseSettingsFromDOM(),l.refreshBorders(null,!0))},this.loadData=function(t){if("object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof t+" given)");var e;t=[];for(var i=0,n=s.settings.startRows;i<n;i++){e=[];for(var l=0,c=s.settings.startCols;l<c;l++)e.push(null);t.push(e)}}s.isPopulated=!1,d.prototype.data=t,s.settings.dataSchema instanceof Array||t[0]instanceof Array?u.dataType="array":"function"==typeof s.settings.dataSchema?u.dataType="function":u.dataType="object",r=new o.DataMap(u,s,d),s.cellSettings.length=0,a.adjustRowsAndCols(),u.PluginHooks.run("afterLoadData"),s.firstRun?s.firstRun=[null,"loadData"]:(u.PluginHooks.run("afterChange",null,"loadData"),u.render()),s.isPopulated=!0},this.getData=function(t,e,o,i){return void 0===t?r.getAll():r.getRange({row:t,col:e},{row:o,col:i},r.DESTINATION_RENDERER)},this.getCopyableData=function(t,e,o,i){return r.getCopyableText({row:t,col:e},{row:o,col:i})},this.updateSettings=function(t,e){var i,n,c,p;if(void 0!==t.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(void 0!==t.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(i in t)"data"!==i&&(void 0!==u.PluginHooks.hooks[i]||void 0!==u.PluginHooks.legacy[i]?("function"==typeof t[i]||o.helper.isArray(t[i]))&&u.PluginHooks.add(i,t[i]):(!e&&t.hasOwnProperty(i)&&(d.prototype[i]=t[i]),o.extension[i]&&(s.extensions[i]=new o.extension[i](u,t[i]))));if(void 0===t.data&&void 0===s.settings.data?u.loadData(null):void 0!==t.data?u.loadData(t.data):void 0!==t.columns&&r.createMap(),n=u.countCols(),s.cellSettings.length=0,n>0)for(i=0;i<n;i++)s.columnSettings[i]=o.helper.columnFactory(d,s.columnsSettingConflicts),c=s.columnSettings[i].prototype,d.prototype.columns&&(p=d.prototype.columns[i],o.helper.extend(c,p),o.helper.extend(c,v(p)));void 0!==t.fillHandle&&(h.handle&&!1===t.fillHandle?h.disable():h.handle||!1===t.fillHandle||h.init()),void 0!==t.className&&(d.prototype.className&&u.rootElement.removeClass(d.prototype.className),t.className&&u.rootElement.addClass(t.className)),e||u.PluginHooks.run("afterUpdateSettings"),a.adjustRowsAndCols(),u.view&&!s.firstRun&&(u.forceFullRender=!0,l.refreshBorders(null,!0))},this.getValue=function(){var t=u.getSelected();if(d.prototype.getValue){if("function"==typeof d.prototype.getValue)return d.prototype.getValue.call(u);if(t)return u.getData()[t[0]][d.prototype.getValue]}else if(t)return u.getDataAtCell(t[0],t[1])},this.getSettings=function(){return s.settings},this.getSettingsFromDOM=function(){return s.settingsFromDOM},this.clear=function(){l.selectAll(),l.empty()},this.alter=function(t,e,o,i,n){a.alter(t,e,o,i,n)},this.getCell=function(t,e){return u.view.getCellAtCoords({row:t,col:e})},this.colToProp=function(t){return r.colToProp(t)},this.propToCol=function(t){return r.propToCol(t)},this.getDataAtCell=function(t,e){return r.get(t,r.colToProp(e))},this.getDataAtRowProp=function(t,e){return r.get(t,e)},this.getDataAtCol=function(t){return[].concat.apply([],r.getRange({row:0,col:t},{row:s.settings.data.length-1,col:t},r.DESTINATION_RENDERER))},this.getDataAtProp=function(t){return[].concat.apply([],r.getRange({row:0,col:r.propToCol(t)},{row:s.settings.data.length-1,col:r.propToCol(t)},r.DESTINATION_RENDERER))},this.getDataAtRow=function(t){return s.settings.data[t]},this.getCellMeta=function(t,e){var i,n,a,l=r.colToProp(e);if(n={row:t},u.PluginHooks.execute("beforeGet",n),t=n.row,a=e,e=o.PluginHooks.execute(u,"modifyCol",a),void 0===s.columnSettings[e]&&(s.columnSettings[e]=o.helper.columnFactory(d,s.columnsSettingConflicts)),s.cellSettings[t]||(s.cellSettings[t]=[]),s.cellSettings[t][e]||(s.cellSettings[t][e]=new s.columnSettings[e]),(i=s.cellSettings[t][e]).row=t,i.col=e,i.prop=l,i.instance=u,u.PluginHooks.run("beforeGetCellMeta",t,e,i),o.helper.extend(i,v(i)),i.cells){var c=i.cells.call(i,t,e,l);c&&(o.helper.extend(i,c),o.helper.extend(i,v(c)))}return u.PluginHooks.run("afterGetCellMeta",t,e,i),i};var b=o.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(t,e){var i=b.call(this,t,e);return o.renderers.getRenderer(i)},this.getCellEditor=o.helper.cellMethodLookupFactory("editor"),this.getCellValidator=o.helper.cellMethodLookupFactory("validator"),this.validateCells=function(t){var e=new g;e.onQueueEmpty=t;for(var o=u.countRows()-1;o>=0;){for(var i=u.countCols()-1;i>=0;)e.addValidatorToQueue(),u.validateCell(u.getDataAtCell(o,i),u.getCellMeta(o,i),function(){e.removeValidatorFormQueue()},"validateCells"),i--;o--}e.checkIfQueueIsEmpty()},this.getRowHeader=function(t){if(void 0===t){for(var e=[],o=0,i=u.countRows();o<i;o++)e.push(u.getRowHeader(o));return e}return"[object Array]"===Object.prototype.toString.call(s.settings.rowHeaders)&&void 0!==s.settings.rowHeaders[t]?s.settings.rowHeaders[t]:"function"==typeof s.settings.rowHeaders?s.settings.rowHeaders(t):s.settings.rowHeaders&&"string"!=typeof s.settings.rowHeaders&&"number"!=typeof s.settings.rowHeaders?t+1:s.settings.rowHeaders},this.hasRowHeaders=function(){return!!s.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==s.settings.colHeaders&&null!==s.settings.colHeaders)return!!s.settings.colHeaders;for(var t=0,e=u.countCols();t<e;t++)if(u.getColHeader(t))return!0;return!1},this.getColHeader=function(t){if(void 0===t){for(var e=[],i=0,n=u.countCols();i<n;i++)e.push(u.getColHeader(i));return e}return t=o.PluginHooks.execute(u,"modifyCol",t),s.settings.columns&&s.settings.columns[t]&&s.settings.columns[t].title?s.settings.columns[t].title:"[object Array]"===Object.prototype.toString.call(s.settings.colHeaders)&&void 0!==s.settings.colHeaders[t]?s.settings.colHeaders[t]:"function"==typeof s.settings.colHeaders?s.settings.colHeaders(t):s.settings.colHeaders&&"string"!=typeof s.settings.colHeaders&&"number"!=typeof s.settings.colHeaders?o.helper.spreadsheetColumnLabel(t):s.settings.colHeaders},this._getColWidthFromSettings=function(t){var e=u.getCellMeta(0,t),o=e.width;if(void 0!==o&&o!==s.settings.width||(o=e.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[t];break;case"function":o=o(t)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(t){t=o.PluginHooks.execute(u,"modifyCol",t);var e={width:u._getColWidthFromSettings(t)};return e.width||(e.width=50),u.PluginHooks.run("afterGetColWidth",t,e),e.width},this.countRows=function(){return s.settings.data.length},this.countCols=function(){return"object"===u.dataType||"function"===u.dataType?s.settings.columns&&s.settings.columns.length?s.settings.columns.length:r.colToPropCache.length:"array"===u.dataType?s.settings.columns&&s.settings.columns.length?s.settings.columns.length:s.settings.data&&s.settings.data[0]&&s.settings.data[0].length?s.settings.data[0].length:0:void 0},this.rowOffset=function(){return u.view.wt.getSetting("offsetRow")},this.colOffset=function(){return u.view.wt.getSetting("offsetColumn")},this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(t){for(var e=u.countRows()-1,o=0;e>=0;){if(r.get(e,0),u.isEmptyRow(r.getVars.row))o++;else if(t)break;e--}return o},this.countEmptyCols=function(t){if(u.countRows()<1)return 0;for(var e=u.countCols()-1,o=0;e>=0;){if(u.isEmptyCol(e))o++;else if(t)break;e--}return o},this.isEmptyRow=function(t){return s.settings.isEmptyRow.call(u,t)},this.isEmptyCol=function(t){return s.settings.isEmptyCol.call(u,t)},this.selectCell=function(t,e,o,i,n){if("number"!=typeof t||t<0||t>=u.countRows())return!1;if("number"!=typeof e||e<0||e>=u.countCols())return!1;if(void 0!==o){if("number"!=typeof o||o<0||o>=u.countRows())return!1;if("number"!=typeof i||i<0||i>=u.countCols())return!1}return s.selStart.coords({row:t,col:e}),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),u.listen(),void 0===o?l.setRangeEnd({row:t,col:e},n):l.setRangeEnd({row:o,col:i},n),u.selection.finish(),!0},this.selectCellByProp=function(t,e,o,i,n){return arguments[1]=r.propToCol(arguments[1]),void 0!==arguments[3]&&(arguments[3]=r.propToCol(arguments[3])),u.selectCell.apply(u,arguments)},this.deselectCell=function(){l.deselect()},this.destroy=function(){u.clearTimeouts(),u.view&&u.view.wt.destroy(),u.rootElement.empty(),u.rootElement.removeData("handsontable"),u.rootElement.off(".handsontable"),t(e).off("."+u.guid),p.off("."+u.guid),f.off("."+u.guid),u.PluginHooks.run("afterDestroy")},this.getActiveEditor=function(){return c.getActiveEditor()},this.getInstance=function(){return u.rootElement.data("handsontable")},function(){u.PluginHooks=new o.PluginHookClass;var t=u.PluginHooks.run,e=u.PluginHooks.execute;u.PluginHooks.run=function(e,i,n,s,r,a){t.call(this,u,e,i,n,s,r,a),o.PluginHooks.run(u,e,i,n,s,r,a)},u.PluginHooks.execute=function(t,i,n,s,r,a){var l=o.PluginHooks.execute(u,t,i,n,s,r,a),c=e.call(this,u,t,l,n,s,r,a);return void 0===c?l:c},u.addHook=function(){u.PluginHooks.add.apply(u.PluginHooks,arguments)},u.addHookOnce=function(){u.PluginHooks.once.apply(u.PluginHooks,arguments)},u.removeHook=function(){u.PluginHooks.remove.apply(u.PluginHooks,arguments)},u.runHooks=function(){u.PluginHooks.run.apply(u.PluginHooks,arguments)},u.runHooksAndReturn=function(){return u.PluginHooks.execute.apply(u.PluginHooks,arguments)}}(),this.timeouts={},this.registerTimeout=function(t,e,o){clearTimeout(this.timeouts[t]),this.timeouts[t]=setTimeout(e,o||0)},this.clearTimeouts=function(){for(var t in this.timeouts)this.timeouts.hasOwnProperty(t)&&clearTimeout(this.timeouts[t])},this.version="0.10.2"};var i,n,s,r,a,l,c,h,u,d,p,f,g,m,w,y,v,C=function(){};C.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(t){for(var e,o=0,i=this.countCols();o<i;o++)if(""!==(e=this.getDataAtCell(t,o))&&null!==e&&void 0!==e)return!1;return!0},isEmptyCol:function(t){for(var e,o=0,i=this.countRows();o<i;o++)if(""!==(e=this.getDataAtCell(o,t))&&null!==e&&void 0!==e)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:!1,readOnly:!1,nativeScrollbars:!1,type:"text",copyable:!0,debug:!1},o.DefaultSettings=C,t.fn.handsontable=function(t){var e,i,n,s,r,a=this.first(),l=a.data("handsontable");if("string"!=typeof t)return r=t||{},l?l.updateSettings(r):(l=new o.Core(a,r),a.data("handsontable",l),l.init()),a;if(n=[],arguments.length>1)for(e=1,i=arguments.length;e<i;e++)n.push(arguments[e]);if(l){if(void 0===l[t])throw new Error("Handsontable do not provide action: "+t);s=l[t].apply(l,n)}return s},o.TableView=function(i){var n=this,s=t(e),r=t(document.documentElement);this.instance=i,this.settings=i.getSettings(),this.settingsFromDOM=i.getSettingsFromDOM(),i.rootElement.data("originalStyle",i.rootElement[0].getAttribute("style")),i.rootElement.addClass("handsontable");var a,l=document.createElement("TABLE");l.className="htCore",this.THEAD=document.createElement("THEAD"),l.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),l.appendChild(this.TBODY),i.$table=t(l),i.rootElement.prepend(i.$table),i.rootElement.on("mousedown.handsontable",function(t){n.isTextSelectionAllowed(t.target)||(c(),t.preventDefault(),e.focus())}),r.on("keyup."+i.guid,function(t){i.selection.isInProgress()&&!t.shiftKey&&i.selection.finish()}),r.on("mouseup."+i.guid,function(t){i.selection.isInProgress()&&1===t.which&&i.selection.finish(),a=!1,i.autofill.handle&&i.autofill.handle.isDragged&&(i.autofill.handle.isDragged>1&&i.autofill.apply(),i.autofill.handle.isDragged=0),o.helper.isOutsideInput(document.activeElement)&&i.unlisten()}),r.on("mousedown."+i.guid,function(t){var e=t.target;if(e!==n.wt.wtTable.spreader)for(;e!==document.documentElement;){if(null===e)return;if(e===i.rootElement[0]||"HANDSONTABLE-TABLE"===e.nodeName)return;e=e.parentNode}n.settings.outsideClickDeselects?i.deselectCell():i.destroyEditor()}),i.rootElement.on("mousedown.handsontable",".dragdealer",function(){i.destroyEditor()}),i.$table.on("selectstart",function(t){n.settings.fragmentSelection||t.preventDefault()});var c=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},h={debug:function(){return n.settings.debug},table:l,stretchH:this.settings.stretchH,data:i.getDataAtCell,totalRows:i.countRows,totalColumns:i.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},rowHeaders:function(){return i.hasRowHeaders()?[function(t,e){n.appendRowHeader(t,e)}]:[]},columnHeaders:function(){return i.hasColHeaders()?[function(t,e){n.appendColHeader(t,e)}]:[]},columnWidth:i.getColWidth,cellRenderer:function(t,e,o){var i=n.instance.colToProp(e),s=n.instance.getCellMeta(t,e),r=n.instance.getCellRenderer(s),a=n.instance.getDataAtRowProp(t,i);r(n.instance,o,t,e,i,a,s),n.instance.PluginHooks.run("afterRenderer",o,t,e,i,a,s)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!i.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&i.selection.isMultiple()}}},highlight:{highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(t,e,o){i.listen(),a=!0;var n={row:e[0],col:e[1]};2===t.button&&i.selection.inInSelection(n)||(t.shiftKey?i.selection.setRangeEnd(n):i.selection.setRangeStart(n)),i.PluginHooks.run("afterOnCellMouseDown",t,e,o)},onCellMouseOver:function(t,e,o){var n={row:e[0],col:e[1]};a?i.selection.setRangeEnd(n):i.autofill.handle&&i.autofill.handle.isDragged&&(i.autofill.handle.isDragged++,i.autofill.showBorder(e)),i.PluginHooks.run("afterOnCellMouseOver",t,e,o)},onCellCornerMouseDown:function(t){i.autofill.handle.isDragged=1,t.preventDefault(),i.PluginHooks.run("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(){i.autofill.selectAdjacent()},beforeDraw:function(t){n.beforeRender(t)},onDraw:function(t){n.onDraw(t)},onScrollVertically:function(){i.runHooks("afterScrollVertically")},onScrollHorizontally:function(){i.runHooks("afterScrollHorizontally")}};i.PluginHooks.run("beforeInitWalkontable",h),this.wt=new j(h),s.on("resize."+i.guid,function(){i.registerTimeout("resizeTimeout",function(){i.parseSettingsFromDOM();var t=n.getWidth(),e=n.getHeight();h.width===t&&h.height===e||(i.forceFullRender=!0,n.render(),h.width=t,h.height=e)},60)}),t(n.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(t){t.target===n.wt.wtTable.spreader&&3===t.which&&t.stopPropagation()}),r.on("click."+i.guid,function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})},o.TableView.prototype.isTextSelectionAllowed=function(t){return!!o.helper.isInput(t)||!(!this.settings.fragmentSelection||!this.wt.wtDom.isChildOf(t,this.TBODY))},o.TableView.prototype.isCellEdited=function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()},o.TableView.prototype.getWidth=function(){var t=void 0!==this.settings.width?this.settings.width:this.settingsFromDOM.width;return"function"==typeof t?t():t},o.TableView.prototype.getHeight=function(){var t=void 0!==this.settings.height?this.settings.height:this.settingsFromDOM.height;return"function"==typeof t?t():t},o.TableView.prototype.beforeRender=function(t){t&&(this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender),this.wt.update("width",this.getWidth()),this.wt.update("height",this.getHeight()))},o.TableView.prototype.onDraw=function(t){t&&this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)},o.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},o.TableView.prototype.getCellAtCoords=function(t){var e=this.wt.wtTable.getCell([t.row,t.col]);return e<0?null:e},o.TableView.prototype.scrollViewport=function(t){this.wt.scrollViewport([t.row,t.col])},o.TableView.prototype.appendRowHeader=function(t,e){if(t>-1)this.wt.wtDom.fastInnerHTML(e,this.instance.getRowHeader(t));else{var o=document.createElement("DIV");o.className="relative",this.wt.wtDom.fastInnerText(o," "),this.wt.wtDom.empty(e),e.appendChild(o)}},o.TableView.prototype.appendColHeader=function(t,e){var o=document.createElement("DIV"),i=document.createElement("SPAN");o.className="relative",i.className="colHeader",this.wt.wtDom.fastInnerHTML(i,this.instance.getColHeader(t)),o.appendChild(i),this.wt.wtDom.empty(e),e.appendChild(o),this.instance.PluginHooks.run("afterGetColHeader",t,e)},o.TableView.prototype.maximumVisibleElementWidth=function(t){var e=this.wt.wtViewport.getWorkspaceWidth();return this.settings.nativeScrollbars?e:e-t},o.TableView.prototype.maximumVisibleElementHeight=function(t){var e=this.wt.wtViewport.getWorkspaceHeight();return this.settings.nativeScrollbars?e:e-t},function(t){var e={},o=new WeakMap;t.editors={registerEditor:function(t,i){var n=new function(t){var e,o;o={},e=t,this.getInstance=function(t){return t.guid in o||(o[t.guid]=new e(t)),o[t.guid]}}(i);"string"==typeof t&&(e[t]=n),o.set(i,n)},getEditor:function(t,i){var n;if("function"==typeof t)o.get(t)||this.registerEditor(null,t),n=o.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter ');n=e[t]}if(!n)throw Error('No editor registered under name "'+t+'"');return n.getInstance(i)}}}(o),(i=o).EditorManager=function(e,o,n){var s,r=this,a=t(document),l=i.helper.keyCode;this.destroyEditor=function(t){this.closeEditor(t)},this.getActiveEditor=function(){return s},this.prepareEditor=function(){if(s&&s.isWaiting())this.closeEditor(!1,!1,function(t){t&&r.prepareEditor()});else{var t=o.selStart.row(),n=o.selStart.col(),a=e.colToProp(n),l=e.getCell(t,n),c=e.getDataAtCell(t,n),h=e.getCellMeta(t,n),u=e.getCellEditor(h);(s=i.editors.getEditor(u,e)).prepare(t,n,a,l,c,h)}},this.isEditorOpened=function(){return s.isOpened()},this.openEditor=function(t){s.beginEditing(t)},this.closeEditor=function(t,e,o){s?s.finishEditing(t,e,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(t){return this.closeEditor(!1,t)},this.closeEditorAndRestoreOriginalValue=function(t){return this.closeEditor(!0,t)},function(){function t(t){var e="function"==typeof o.settings.enterMoves?o.settings.enterMoves(event):o.settings.enterMoves;t?n.transformStart(-e.row,-e.col):n.transformStart(e.row,e.col,!0)}a.on("keydown.handsontable."+e.guid,function(a){if(e.isListening()&&(o.settings.beforeOnKeyDown&&o.settings.beforeOnKeyDown.call(e,a),e.PluginHooks.run("beforeKeyDown",a),!a.isImmediatePropagationStopped()&&(o.lastKeyCode=a.keyCode,n.isSelected()))){var c=(a.ctrlKey||a.metaKey)&&!a.altKey;if(!s.isWaiting()&&!i.helper.isMetaKey(a.keyCode)&&!c)return r.openEditor(""),void a.stopPropagation();var h=a.shiftKey?n.setRangeEnd:n.setRangeStart;switch(a.keyCode){case l.A:if(c){n.selectAll(),a.preventDefault(),a.stopPropagation();break}case l.ARROW_UP:r.isEditorOpened()&&!s.isWaiting()&&r.closeEditorAndSaveChanges(c),a.shiftKey?n.transformEnd(-1,0):n.transformStart(-1,0),a.preventDefault(),a.stopPropagation();break;case l.ARROW_DOWN:r.isEditorOpened()&&!s.isWaiting()&&r.closeEditorAndSaveChanges(c),a.shiftKey?n.transformEnd(1,0):n.transformStart(1,0),a.preventDefault(),a.stopPropagation();break;case l.ARROW_RIGHT:r.isEditorOpened()&&!s.isWaiting()&&r.closeEditorAndSaveChanges(c),a.shiftKey?n.transformEnd(0,1):n.transformStart(0,1),a.preventDefault(),a.stopPropagation();break;case l.ARROW_LEFT:r.isEditorOpened()&&!s.isWaiting()&&r.closeEditorAndSaveChanges(c),a.shiftKey?n.transformEnd(0,-1):n.transformStart(0,-1),a.preventDefault(),a.stopPropagation();break;case l.TAB:var u="function"==typeof o.settings.tabMoves?o.settings.tabMoves(a):o.settings.tabMoves;a.shiftKey?n.transformStart(-u.row,-u.col):n.transformStart(u.row,u.col,!0),a.preventDefault(),a.stopPropagation();break;case l.BACKSPACE:case l.DELETE:n.empty(a),r.prepareEditor(),a.preventDefault();break;case l.F2:r.openEditor(),a.preventDefault();break;case l.ENTER:r.isEditorOpened()?(s.state!==i.EditorState.WAITING&&r.closeEditorAndSaveChanges(c),t(a.shiftKey)):e.getSettings().enterBeginsEditing?r.openEditor():t(a.shiftKey),a.preventDefault(),a.stopImmediatePropagation();break;case l.ESCAPE:r.isEditorOpened()&&r.closeEditorAndRestoreOriginalValue(c),a.preventDefault();break;case l.HOME:a.ctrlKey||a.metaKey?h({row:0,col:o.selStart.col()}):h({row:o.selStart.row(),col:0}),a.preventDefault(),a.stopPropagation();break;case l.END:a.ctrlKey||a.metaKey?h({row:e.countRows()-1,col:o.selStart.col()}):h({row:o.selStart.row(),col:e.countCols()-1}),a.preventDefault(),a.stopPropagation();break;case l.PAGE_UP:n.transformStart(-e.countVisibleRows(),0),e.view.wt.scrollVertical(-e.countVisibleRows()),e.view.render(),a.preventDefault(),a.stopPropagation();break;case l.PAGE_DOWN:n.transformStart(e.countVisibleRows(),0),e.view.wt.scrollVertical(e.countVisibleRows()),e.view.render(),a.preventDefault(),a.stopPropagation()}}}),e.view.wt.update("onCellDblClick",function(){r.openEditor()}),e.addHook("afterDestroy",function(){a.off("keydown.handsontable."+e.guid)})}()},n={},o.renderers={registerRenderer:function(t,e){n[t]=e},getRenderer:function(t){if("function"==typeof t)return t;if("string"!=typeof t)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(t in n))throw Error('No editor registered under name "'+t+'"');return n[t]}},o.Dom=new $,o.helper.isPrintableChar=function(t){return 32==t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90},o.helper.isMetaKey=function(t){var e=o.helper.keyCode;return-1!=[e.ARROW_DOWN,e.ARROW_UP,e.ARROW_LEFT,e.ARROW_RIGHT,e.HOME,e.END,e.DELETE,e.BACKSPACE,e.F1,e.F2,e.F3,e.F4,e.F5,e.F6,e.F7,e.F8,e.F9,e.F10,e.F11,e.F12,e.TAB,e.PAGE_DOWN,e.PAGE_UP,e.ENTER,e.ESCAPE,e.SHIFT,e.CAPS_LOCK,e.ALT].indexOf(t)},o.helper.isCtrlKey=function(t){var e=o.helper.keyCode;return-1!=[e.CONTROL_LEFT,224,e.COMMAND_LEFT,e.COMMAND_RIGHT].indexOf(t)},o.helper.stringify=function(t){switch(typeof t){case"string":case"number":return t+"";case"object":return null===t?"":t.toString();case"undefined":return"";default:return t.toString()}},o.helper.spreadsheetColumnLabel=function(t){for(var e,o=t+1,i="";o>0;)e=(o-1)%26,i=String.fromCharCode(65+e)+i,o=parseInt((o-e)/26,10);return i},o.helper.isNumeric=function(t){var e=typeof t;return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?!!t.length&&(1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t)):"object"==e&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)},o.helper.isArray=function(t){return null!==Object.prototype.toString.call(t).match(/array/i)},o.helper.isDescendant=function(t,e){for(var o=e.parentNode;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},o.helper.randomString=function(){return K()},o.helper.inherit=function(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t},o.helper.extend=function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},o.helper.getPrototypeOf=function(t){var e;if("object"==typeof t.__proto__)e=t.__proto__;else{var o,i=t.constructor;"function"==typeof t.constructor&&(o=i,delete t.constructor&&(i=t.constructor,t.constructor=o)),e=i?i.prototype:null}return e},o.helper.columnFactory=function(t,e){function i(){}o.helper.inherit(i,t);for(var n=0,s=e.length;n<s;n++)i.prototype[e[n]]=void 0;return i},o.helper.translateRowsToColumns=function(t){var e,o,i,n,s=[],r=0;for(e=0,o=t.length;e<o;e++)for(i=0,n=t[e].length;i<n;i++)i==r&&(s.push([]),r++),s[i].push(t[e][i]);return s},o.helper.to2dArray=function(t){for(var e=0,o=t.length;e<o;)t[e]=[t[e]],e++},o.helper.extendArray=function(t,e){for(var o=0,i=e.length;o<i;)t.push(e[o]),o++},o.helper.isInput=function(t){return["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1},o.helper.isOutsideInput=function(t){return o.helper.isInput(t)&&-1==t.className.indexOf("handsontableInput")},o.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},o.helper.isObject=function(t){return"[object Object]"==Object.prototype.toString.call(t)},o.helper.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"==Object.prototype.toString.call(t)},o.helper.pivot=function(t){var e=[];if(!t||0==t.length||!t[0]||0==t[0].length)return e;for(var o=t.length,i=t[0].length,n=0;n<o;n++)for(var s=0;s<i;s++)e[s]||(e[s]=[]),e[s][n]=t[n][s];return e},o.helper.proxy=function(t,e){return function(){return t.apply(e,arguments)}},o.helper.cellMethodLookupFactory=function(t){return function(e,i){return function e(i){if(i){if(i.hasOwnProperty(t)&&i[t])return i[t];if(i.hasOwnProperty("type")&&i.type){if("string"!=typeof i.type)throw new Error("Cell type must be a string ");return function(t){var e=o.cellTypes[t];if(void 0===e)throw new Error('You declared cell type "'+t+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return e}(i.type)[t]}return e(o.helper.getPrototypeOf(i))}}("number"==typeof e?this.getCellMeta(e,i):e)}},o.SelectionPoint=function(){this._row=null,this._col=null},o.SelectionPoint.prototype.exists=function(){return null!==this._row},o.SelectionPoint.prototype.row=function(t){return void 0!==t&&(this._row=t),this._row},o.SelectionPoint.prototype.col=function(t){return void 0!==t&&(this._col=t),this._col},o.SelectionPoint.prototype.coords=function(t){return void 0!==t&&(this._row=t.row,this._col=t.col),{row:this._row,col:this._col}},o.SelectionPoint.prototype.arr=function(t){return void 0!==t&&(this._row=t[0],this._col=t[1]),[this._row,this._col]},function(e){e.DataMap=function(t,e,o){this.instance=t,this.priv=e,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.getVars={},this.setVars={}},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var o;if(t.isPlainObject(e)){o={};for(var i in e)e.hasOwnProperty(i)&&(t.isPlainObject(e[i])?o[i]=this.recursiveDuckSchema(e[i]):o[i]=null)}else o=[];return o},e.DataMap.prototype.recursiveDuckColumns=function(e,o,i){var n,s;if(void 0===o&&(o=0,i=""),t.isPlainObject(e))for(s in e)e.hasOwnProperty(s)&&(null===e[s]?(n=i+s,this.colToPropCache.push(n),this.propToColCache[n]=o,o++):o=this.recursiveDuckColumns(e[s],o,s+"."));return o},e.DataMap.prototype.createMap=function(){if(void 0===this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var t,e,o=this.getSchema();this.colToPropCache=[],this.propToColCache={};var i=this.instance.getSettings().columns;if(i)for(t=0,e=i.length;t<e;t++)this.colToPropCache[t]=i[t].data,this.propToColCache[i[t].data]=t;else this.recursiveDuckColumns(o)},e.DataMap.prototype.colToProp=function(t){return t=e.PluginHooks.execute(this.instance,"modifyCol",t),this.colToPropCache&&void 0!==this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var o;return o=void 0!==this.propToColCache[t]?this.propToColCache[t]:t,o=e.PluginHooks.execute(this.instance,"modifyCol",o)},e.DataMap.prototype.getSchema=function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema},e.DataMap.prototype.createRow=function(e,o){var i,n=this.instance.countCols(),s=0;o||(o=1),("number"!=typeof e||e>=this.instance.countRows())&&(e=this.instance.countRows());for(var r=this.instance.getSettings().maxRows;s<o&&this.instance.countRows()<r;){if("array"===this.instance.dataType){i=[];for(var a=0;a<n;a++)i.push(null)}else i="function"===this.instance.dataType?this.instance.getSettings().dataSchema(e):t.extend(!0,{},this.getSchema());e===this.instance.countRows()?this.dataSource.push(i):this.dataSource.splice(e,0,i),s++,0}return this.instance.PluginHooks.run("afterCreateRow",e,s),this.instance.forceFullRender=!0,s},e.DataMap.prototype.createCol=function(t,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,n,s=this.instance.countRows(),r=this.dataSource,a=0;o||(o=1),n=t;for(var l=this.instance.getSettings().maxCols;a<o&&this.instance.countCols()<l;){if(i=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var c=0;c<s;c++)void 0===r[c]&&(r[c]=[]),r[c].push(null);this.priv.columnSettings.push(i)}else{for(c=0;c<s;c++)r[c].splice(n,0,null);this.priv.columnSettings.splice(n,0,i)}a++,n++}return this.instance.PluginHooks.run("afterCreateCol",t,a),this.instance.forceFullRender=!0,a},e.DataMap.prototype.removeRow=function(t,e){e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countRows()+t)%this.instance.countRows();var o=this.physicalRowsToLogical(t,e);if(!1!==this.instance.PluginHooks.execute("beforeRemoveRow",t,e)){var i=this.dataSource,n=i.filter(function(t,e){return-1==o.indexOf(e)});i.length=0,Array.prototype.push.apply(i,n),this.instance.PluginHooks.run("afterRemoveRow",t,e),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,e){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countCols()+t)%this.instance.countCols(),!1!==this.instance.PluginHooks.execute("beforeRemoveCol",t,e)){for(var o=this.dataSource,i=0,n=this.instance.countRows();i<n;i++)o[i].splice(t,e);this.priv.columnSettings.splice(t,e),this.instance.PluginHooks.run("afterRemoveCol",t,e),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,o,i){var n=4<=arguments.length?[].slice.call(arguments,3):[],s=this.instance.getDataAtCol(t),r=s.slice(o,o+i),a=s.slice(o+i);e.helper.extendArray(n,a);for(var l=0;l<i;)n.push(null),l++;return e.helper.to2dArray(n),this.instance.populateFromArray(o,t,n,null,null,"spliceCol"),r},e.DataMap.prototype.spliceRow=function(t,o,i){var n=4<=arguments.length?[].slice.call(arguments,3):[],s=this.instance.getDataAtRow(t),r=s.slice(o,o+i),a=s.slice(o+i);e.helper.extendArray(n,a);for(var l=0;l<i;)n.push(null),l++;return this.instance.populateFromArray(t,o,[n],null,null,"spliceRow"),r},e.DataMap.prototype.get=function(t,e){if(this.getVars.row=t,this.getVars.prop=e,this.instance.PluginHooks.run("beforeGet",this.getVars),"string"==typeof this.getVars.prop&&this.getVars.prop.indexOf(".")>-1){var o=this.getVars.prop.split("."),i=this.dataSource[this.getVars.row];if(!i)return null;for(var n=0,s=o.length;n<s;n++)if(void 0===(i=i[o[n]]))return null;return i}return"function"==typeof this.getVars.prop?this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0]):this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null};var o=e.helper.cellMethodLookupFactory("copyable");e.DataMap.prototype.getCopyable=function(t,e){return o.call(this.instance,t,this.propToCol(e))?this.get(t,e):""},e.DataMap.prototype.set=function(t,e,o,i){if(this.setVars.row=t,this.setVars.prop=e,this.setVars.value=o,this.instance.PluginHooks.run("beforeSet",this.setVars,i||"datamapGet"),"string"==typeof this.setVars.prop&&this.setVars.prop.indexOf(".")>-1){for(var n=this.setVars.prop.split("."),s=this.dataSource[this.setVars.row],r=0,a=n.length-1;r<a;r++)s=s[n[r]];s[n[r]]=this.setVars.value}else"function"==typeof this.setVars.prop?this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value):this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value},e.DataMap.prototype.physicalRowsToLogical=function(t,e){for(var o=this.instance.countRows(),i=(o+t)%o,n=[],s=e;i<o&&s;)this.get(i,0),n.push(this.getVars.row),s--,i++;return n},e.DataMap.prototype.clear=function(){for(var t=0;t<this.instance.countRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(t,e,o){var i,n,s,r,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(n=Math.max(t.row,e.row),r=Math.max(t.col,e.col),i=Math.min(t.row,e.row);i<=n;i++){for(a=[],s=Math.min(t.col,e.col);s<=r;s++)a.push(c.call(this,i,this.colToProp(s)));l.push(a)}return l},e.DataMap.prototype.getText=function(t,e){return SheetClip.stringify(this.getRange(t,e,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(t,e){return SheetClip.stringify(this.getRange(t,e,this.DESTINATION_CLIPBOARD_GENERATOR))}}(o),o.renderers.cellDecorator=function(t,e,o,i,n,s,r){r.readOnly&&t.view.wt.wtDom.addClass(e,r.readOnlyCellClassName),!1===r.valid&&r.invalidCellClassName&&t.view.wt.wtDom.addClass(e,r.invalidCellClassName),!s&&r.placeholder&&t.view.wt.wtDom.addClass(e,r.placeholderCellClassName)},r=function(t,e,o,i,n,r,a){s.renderers.cellDecorator.apply(this,arguments),!r&&a.placeholder&&(r=a.placeholder);var l=s.helper.stringify(r);if(a.rendererTemplate){t.view.wt.wtDom.empty(e);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getDataAtRow(o),e.appendChild(c)}else t.view.wt.wtDom.fastInnerText(e,l)},(s=o).renderers.TextRenderer=r,s.renderers.registerRenderer("text",r),function(t){var e=document.createElement("DIV");e.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode("▼"));var i=function(i,n,s,r,a,l,c){e.cloneNode(!0);var h=o.cloneNode(!0);t.renderers.TextRenderer(i,n,s,r,a,l,c),n.appendChild(h),t.Dom.addClass(n,"htAutocomplete"),n.firstChild||n.appendChild(document.createTextNode(" ")),i.acArrowListener||(i.acArrowListener=function(){i.view.wt.getSetting("onCellDblClick")},i.rootElement.on("mousedown",".htAutocompleteArrow",i.acArrowListener))};t.AutocompleteRenderer=i,t.renderers.AutocompleteRenderer=i,t.renderers.registerRenderer("autocomplete",i)}(o),function(e){var o=document.createElement("INPUT");o.className="htCheckboxRendererInput",o.type="checkbox",o.setAttribute("autocomplete","off");var i=function(i,n,s,r,a,l,c){void 0===c.checkedTemplate&&(c.checkedTemplate=!0),void 0===c.uncheckedTemplate&&(c.uncheckedTemplate=!1),i.view.wt.wtDom.empty(n);var h=o.cloneNode(!1);l===c.checkedTemplate||l===e.helper.stringify(c.checkedTemplate)?(h.checked=!0,n.appendChild(h)):l===c.uncheckedTemplate||l===e.helper.stringify(c.uncheckedTemplate)?n.appendChild(h):null===l?(h.className+=" noValue",n.appendChild(h)):i.view.wt.wtDom.fastInnerText(n,"#bad value#");var u=t(h);c.readOnly?u.on("click",function(t){t.preventDefault()}):(u.on("mousedown",function(t){t.stopPropagation()}),u.on("mouseup",function(t){t.stopPropagation()}),u.on("change",function(){this.checked?i.setDataAtRowProp(s,a,c.checkedTemplate):i.setDataAtRowProp(s,a,c.uncheckedTemplate)})),i.CheckboxRenderer&&i.CheckboxRenderer.beforeKeyDownHookBound||(i.CheckboxRenderer={beforeKeyDownHookBound:!0},i.addHook("beforeKeyDown",function(o){if(o.keyCode==e.helper.keyCode.SPACE)for(var n,s,r,a=i.getSelected(),l={row:Math.min(a[0],a[2]),col:Math.min(a[1],a[3])},c={row:Math.max(a[0],a[2]),col:Math.max(a[1],a[3])},h=l.row;h<=c.row;h++)for(var u=c.col;u<=c.col;u++)if(n=i.getCell(h,u),r=i.getCellMeta(h,u),(s=n.querySelectorAll("input[type=checkbox]")).length>0&&!r.readOnly){o.isImmediatePropagationStopped()||(o.stopImmediatePropagation(),o.preventDefault());for(var d=0,p=s.length;d<p;d++)s[d].checked=!s[d].checked,t(s[d]).trigger("change")}}))};e.CheckboxRenderer=i,e.renderers.CheckboxRenderer=i,e.renderers.registerRenderer("checkbox",i)}(o),l=function(t,e,o,i,n,s,r){a.helper.isNumeric(s)&&(void 0!==r.language&&numeral.language(r.language),s=numeral(s).format(r.format||"0"),t.view.wt.wtDom.addClass(e,"htNumeric")),a.renderers.TextRenderer(t,e,o,i,n,s,r)},(a=o).NumericRenderer=l,a.renderers.NumericRenderer=l,a.renderers.registerRenderer("numeric",l),h=function(t,e,i,n,s,r,a){var l;o.renderers.TextRenderer.apply(this,arguments),r=e.innerHTML;var c=a.hashLength||r.length,h=a.hashSymbol||"*";for(l="";l.split(h).length-1<c;l+=h);t.view.wt.wtDom.fastInnerHTML(e,l)},(c=o).PasswordRenderer=h,c.renderers.PasswordRenderer=h,c.renderers.registerRenderer("password",h),function(t){function e(e,o,i,n,s,r,a){t.renderers.cellDecorator.apply(this,arguments),t.Dom.fastInnerHTML(o,r)}t.renderers.registerRenderer("html",e),t.renderers.HtmlRenderer=e}(o),function(t){function e(e){this.instance=e,this.state=t.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},e.prototype._fireCallbacks=function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)},e.prototype.init=function(){},e.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},e.prototype.setValue=function(t){throw Error("Editor setValue() method unimplemented")},e.prototype.open=function(){throw Error("Editor open() method unimplemented")},e.prototype.close=function(){throw Error("Editor close() method unimplemented")},e.prototype.prepare=function(e,o,i,n,s,r){this.TD=n,this.row=e,this.col=o,this.prop=i,this.originalValue=s,this.cellProperties=r,this.state=t.EditorState.VIRGIN},e.prototype.extend=function(){var t=this.constructor;return function(t,e){function o(){}return o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t,t}(function(){t.apply(this,arguments)},t)},e.prototype.saveValue=function(t,e){if(e){var o=this.instance.getSelected();this.instance.populateFromArray(o[0],o[1],t,o[2],o[3],"edit")}else this.instance.populateFromArray(this.row,this.col,t,null,null,"edit")},e.prototype.beginEditing=function(e){this.state==t.EditorState.VIRGIN&&(this.cellProperties.readOnly||(this.instance.view.scrollViewport({row:this.row,col:this.col}),this.instance.view.render(),this.state=t.EditorState.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue(t.helper.stringify(e)),this.open(),this._opened=!0,this.focus(),this.instance.view.render()))},e.prototype.finishEditing=function(e,o,i){if(i){var n=this._closeCallback;this._closeCallback=function(t){n&&n(t),i(t)}}if(!this.isWaiting())if(this.state!=t.EditorState.VIRGIN){if(this.state==t.EditorState.EDITING){if(e)return void this.cancelChanges();var s=[[String.prototype.trim.call(this.getValue())]];if(this.state=t.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)){r=this;this.instance.addHookOnce("afterValidate",function(e){r.state=t.EditorState.FINISHED,r.discardEditor(e)})}else this.state=t.EditorState.FINISHED,this.discardEditor(!0)}}else{var r=this;setTimeout(function(){r._fireCallbacks(!0)})}},e.prototype.cancelChanges=function(){this.state=t.EditorState.FINISHED,this.discardEditor()},e.prototype.discardEditor=function(e){this.state===t.EditorState.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=t.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=t.EditorState.VIRGIN,this._fireCallbacks(!0)))},e.prototype.isOpened=function(){return this._opened},e.prototype.isWaiting=function(){return this.state===t.EditorState.WAITING},t.editors.BaseEditor=e}(o),function(e){var o=e.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.createElements(),this.bindEvents()},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(t){this.TEXTAREA.value=t};var i=function(t){var o=this.getActiveEditor(),i=e.helper.keyCode,n=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===o.TEXTAREA&&!t.isImmediatePropagationStopped())if(17!==t.keyCode&&224!==t.keyCode&&91!==t.keyCode&&93!==t.keyCode)switch(t.keyCode){case i.ARROW_RIGHT:o.wtDom.getCaretPosition(o.TEXTAREA)!==o.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case i.ARROW_LEFT:0!==o.wtDom.getCaretPosition(o.TEXTAREA)&&t.stopImmediatePropagation();break;case i.ENTER:var s=o.instance.getSelected(),r=!(s[0]===s[2]&&s[1]===s[3]);(n&&!r||t.altKey)&&(o.isOpened()?(o.setValue(o.getValue()+"\n"),o.focus()):o.beginEditing(o.originalValue+"\n"),t.stopImmediatePropagation()),t.preventDefault();break;case i.A:case i.X:case i.C:case i.V:if(n){t.stopImmediatePropagation();break}case i.BACKSPACE:case i.DELETE:case i.HOME:case i.END:t.stopImmediatePropagation()}else t.stopImmediatePropagation()};o.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",i)},o.prototype.close=function(){this.textareaParentStyle.display="none",document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",i)},o.prototype.focus=function(){this.TEXTAREA.focus(),this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.createElements=function(){this.$body=t(document.body),this.wtDom=new $,this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=t(this.TEXTAREA),this.wtDom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var o=this;e.PluginHooks.add("afterRender",function(){o.instance.registerTimeout("refresh_editor_dimensions",function(){o.refreshDimensions()},0)})},o.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.instance.getCell(this.row,this.col),this.TD)){var o=t(this.TD),i=this.wtDom.offset(this.TD),n=this.wtDom.offset(this.instance.rootElement[0]),s=this.instance.rootElement.scrollTop(),r=this.instance.rootElement.scrollLeft(),a=i.top-n.top+s-1,l=i.left-n.left+r-1,c=this.instance.getSettings(),h=!1===c.rowHeaders?0:1,u=!1===c.colHeaders?0:1;a<0&&(a=0),l<0&&(l=0),h>0&&parseInt(o.css("border-top-width"),10)>0&&(a+=1),u>0&&parseInt(o.css("border-left-width"),10)>0&&(l+=1),this.textareaParentStyle.top=a+"px",this.textareaParentStyle.left=l+"px";var d=o.width(),p=this.instance.view.maximumVisibleElementWidth(l)-10,f=o.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(a)-5;parseInt(o.css("border-top-width"),10)>0&&(f-=1),parseInt(o.css("border-left-width"),10)>0&&h>0&&(d-=1),this.$textarea.autoResize({minHeight:Math.min(f,g),maxHeight:g,minWidth:Math.min(d,p),maxWidth:p,animate:!1,extraSpace:0}),this.textareaParentStyle.display="block"}},o.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(t){t.stopPropagation()}),this.$textarea.on("paste.editor",function(t){t.stopPropagation()})},e.editors.TextEditor=o,e.editors.registerEditor("text",e.editors.TextEditor)}(o),(d=(u=o).editors.BaseEditor.prototype.extend()).prototype.beginEditing=function(){this.saveValue([[!this.originalValue]])},d.prototype.finishEditing=function(){},d.prototype.init=function(){},d.prototype.open=function(){},d.prototype.close=function(){},d.prototype.getValue=function(){},d.prototype.setValue=function(){},d.prototype.focus=function(){},u.editors.CheckboxEditor=d,u.editors.registerEditor("checkbox",d),(f=(p=o).editors.TextEditor.prototype.extend()).prototype.init=function(){if(!t.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");p.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var e=this;this.instance.addHook("afterDestroy",function(){e.destroyElements()})},f.prototype.createElements=function(){p.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=t(this.datePicker);var e=this,o={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,altField:this.$textarea,onSelect:function(){e.finishEditing(!1)}};this.$datePicker.datepicker(o),this.$datePicker.on("mousedown",function(t){t.stopPropagation()}),this.hideDatepicker()},f.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},f.prototype.beginEditing=function(t,e,o,i,n){p.editors.TextEditor.prototype.beginEditing.apply(this,arguments),this.showDatepicker()},f.prototype.finishEditing=function(t,e){this.hideDatepicker(),p.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},f.prototype.showDatepicker=function(){var e=t(this.TD),o=e.offset();this.datePickerStyle.top=o.top+e.height()+"px",this.datePickerStyle.left=o.left+"px";var i={defaultDate:this.originalValue||void 0};t.extend(i,this.cellProperties),this.$datePicker.datepicker("option",i),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},f.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},p.editors.DateEditor=f,p.editors.registerEditor("date",f),function(e){var o=e.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var o=document.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.$htContainer=t(o),this.$htContainer.handsontable()},o.prototype.prepare=function(o,i,n,s,r,a){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var t=this.getValue();void 0!==t&&l.setValue(t),l.instance.destroyEditor()},beforeOnKeyDown:function(t){switch(t.keyCode){case e.helper.keyCode.ESCAPE:l.instance.destroyEditor(!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ENTER:var o=this.getSelected(),i=this.getDataAtCell(o[0],o[1]);void 0!==i&&l.setValue(i),l.instance.destroyEditor();break;case e.helper.keyCode.ARROW_UP:this.getSelected()&&0==this.getSelected()[0]&&!l.cellProperties.strict&&(this.deselectCell(),l.instance.listen(),l.focus(),t.preventDefault(),t.stopImmediatePropagation())}}};this.cellProperties.handsontable&&(c=t.extend(c,a.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(c)};var i=function(t){if(!t.isImmediatePropagationStopped()){var o=this.getActiveEditor().$htContainer.handsontable("getInstance");if(t.keyCode==e.helper.keyCode.ARROW_DOWN){if(o.getSelected()){var i=o.getSelected()[0],n=i<o.countRows()-1?i+1:i;o.selectCell(n,0)}else o.selectCell(0,0);t.preventDefault(),t.stopImmediatePropagation()}}};o.prototype.open=function(){this.instance.addHook("beforeKeyDown",i),e.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.$textarea[0].style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.$textarea[0].style.visibility="visible"),this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)},o.prototype.close=function(){this.instance.removeHook("beforeKeyDown",i),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},o.prototype.beginEditing=function(t){var o=this.instance.getSettings().onBeginEditing;o&&!1===o()||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},o.prototype.finishEditing=function(t,o){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var i=this.$htContainer.handsontable("getInstance").getValue();void 0!==i&&this.setValue(i)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},e.editors.HandsontableEditor=o,e.editors.registerEditor("handsontable",o)}(o),function(t){var e,o=t.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.query=null},o.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments),this.$htContainer.addClass("autocompleteEditor")},o.prototype.bindEvents=function(){var e=this;this.$textarea.on("keydown.autocompleteEditor",function(o){t.helper.isMetaKey(o.keyCode)&&-1==[t.helper.keyCode.BACKSPACE,t.helper.keyCode.DELETE].indexOf(o.keyCode)?o.keyCode==t.helper.keyCode.ENTER&&!0!==e.cellProperties.strict&&e.$htContainer.handsontable("deselectCell"):setTimeout(function(){e.queryChoices(e.$textarea.val())})}),this.$htContainer.on("mouseenter",function(){e.$htContainer.handsontable("deselectCell")}),this.$htContainer.on("mouseleave",function(){e.queryChoices(e.query)}),t.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)},o.prototype.beginEditing=function(){t.editors.HandsontableEditor.prototype.beginEditing.apply(this,arguments);var e=this;setTimeout(function(){e.queryChoices(e.TEXTAREA.value)}),this.$htContainer.handsontable("getInstance").updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(t,o,i,n,s,r){var a=t.innerHTML.match(new RegExp(e.query,"i"));a&&(t.innerHTML=s.replace(a[0],"<strong>"+a[0]+"</strong>"))}})},o.prototype.open=function(){var o=this;e=function(e){e.keyCode==t.helper.keyCode.ARROW_UP&&this.getSelected()&&0==this.getSelected()[0]&&(o.cellProperties.strict||this.deselectCell(),o.instance.listen(),o.focus(),e.preventDefault(),e.stopImmediatePropagation())},this.$htContainer.handsontable("getInstance").addHook("beforeKeyDown",e),t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.$textarea[0].style.visibility="visible",o.focus()},o.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",e),t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var o=this;this.cellProperties.source(e,function(t){o.updateChoicesList(t)})}else if(t.helper.isArray(this.cellProperties.source)){var i;if(e&&!1!==this.cellProperties.filter){var n=new RegExp(e,!0===this.cellProperties.filteringCaseSensitive?"":"i");i=this.cellProperties.source.filter(function(t){return n.test(t)})}else i=this.cellProperties.source;this.updateChoicesList(i)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(e){this.$htContainer.handsontable("loadData",t.helper.pivot([e]));var o,i=this.getValue();!0===this.cellProperties.strict&&void 0===(o=function(t,e){for(var o,i,n,s={},r=e.length,a=0,l=t.length;a<l;a++)o=t[a],-1!=(i=r>0?o.indexOf(e):o===e?0:-1)&&(n=o.length-i-r,(void 0===s.indexOfValue||s.indexOfValue>i||s.indexOfValue==i&&s.charsLeft>n)&&(s.indexOfValue=i,s.charsLeft=n,s.index=a));return s.index}(e,i))&&(o=0),void 0===o?this.$htContainer.handsontable("deselectCell"):this.$htContainer.handsontable("selectCell",o,0),this.focus()},t.editors.AutocompleteEditor=o,t.editors.registerEditor("autocomplete",o)}(o),m=(g=o).editors.TextEditor.prototype.extend(),w=new $,m.prototype.createElements=function(){g.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=t(this.TEXTAREA),w.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},g.editors.PasswordEditor=m,g.editors.registerEditor("password",m),function(e){var o=e.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.select=t("<select />").addClass("htSelectEditor").hide(),this.instance.rootElement.append(this.select)},o.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var o,i=this.cellProperties.selectOptions;o="function"==typeof i?this.prepareOptions(i(this.row,this.col,this.prop)):this.prepareOptions(i);var n=[];for(var s in o)if(o.hasOwnProperty(s)){var r=t("<option />");r.val(s),r.html(o[s]),n.push(r)}this.select.empty(),this.select.append(n)},o.prototype.prepareOptions=function(t){var o={};if(e.helper.isArray(t))for(var i=0,n=t.length;i<n;i++)o[t[i]]=t[i];else"object"==typeof t&&(o=t);return o},o.prototype.getValue=function(){return this.select.val()},o.prototype.setValue=function(t){this.select.val(t)};var i=function(t){var o=this.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=o.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var n=o.select.find("option:selected").next();1==n.length&&n.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};o.prototype.open=function(){this.select.css({height:t(this.TD).height(),"min-width":t(this.TD).outerWidth()}),this.select.show(),this.select.offset(t(this.TD).offset()),this.instance.addHook("beforeKeyDown",i)},o.prototype.close=function(){this.select.hide(),this.instance.removeHook("beforeKeyDown",i)},o.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=o,e.editors.registerEditor("select",o)}(o),(v=(y=o).editors.AutocompleteEditor.prototype.extend()).prototype.prepare=function(){y.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},y.editors.DropdownEditor=v,y.editors.registerEditor("dropdown",v),o.NumericValidator=function(t,e){null===t&&(t=""),e(/^-?\d*\.?\d*$/.test(t))};var b=function(t,e){var o=t,i="string"==typeof o?o.toLowerCase():null;return function(t){for(var n=!1,s=0,r=t.length;s<r;s++){if(o===t[s]){n=!0;break}if(i===t[s].toLowerCase()){n=!0;break}}e(n)}};o.AutocompleteValidator=function(t,e){this.strict&&this.source?"function"==typeof this.source?this.source(t,b(t,e)):b(t,e)(this.source):e(!0)},o.AutocompleteCell={editor:o.editors.AutocompleteEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.CheckboxCell={editor:o.editors.CheckboxEditor,renderer:o.renderers.CheckboxRenderer},o.TextCell={editor:o.editors.TextEditor,renderer:o.renderers.TextRenderer},o.NumericCell={editor:o.editors.TextEditor,renderer:o.renderers.NumericRenderer,validator:o.NumericValidator,dataType:"number"},o.DateCell={editor:o.editors.DateEditor,renderer:o.renderers.AutocompleteRenderer},o.HandsontableCell={editor:o.editors.HandsontableEditor,renderer:o.renderers.AutocompleteRenderer},o.PasswordCell={editor:o.editors.PasswordEditor,renderer:o.renderers.PasswordRenderer,copyable:!1},o.DropdownCell={editor:o.editors.DropdownEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.cellTypes={text:o.TextCell,date:o.DateCell,numeric:o.NumericCell,checkbox:o.CheckboxCell,autocomplete:o.AutocompleteCell,handsontable:o.HandsontableCell,password:o.PasswordCell,dropdown:o.DropdownCell},o.cellLookup={validator:{numeric:o.NumericValidator,autocomplete:o.AutocompleteValidator}},function(t){function e(i){return this.filter(e.resizableFilterSelector).each(function(){new o(t(this),i)}),this}function o(o,i){this.clones||(this.config=t.extend({},e.defaults,i),this.el=o,this.nodeName=o[0].nodeName.toLowerCase(),this.previousScrollTop=null,"original"===i.maxWidth&&(i.maxWidth=o.width()),"original"===i.minWidth&&(i.minWidth=o.width()),"original"===i.maxHeight&&(i.maxHeight=o.height()),"original"===i.minHeight&&(i.minHeight=o.height()),"textarea"===this.nodeName&&o.css({resize:"none",overflowY:"none"}),o.data("AutoResizer",this),this.createClone(),this.injectClone(),this.bind())}e.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500},e.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"],e.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"},e.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]",e.AutoResizer=o,t.fn.autoResize=e,o.prototype={bind:function(){var e=t.proxy(function(){return this.check(),!0},this);this.unbind(),this.el.bind("keyup.autoResize",e).bind("change.autoResize",e),this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var o=this.el,i=this,n=this.config;this.clones=t(),"original"===n.minHeight&&"original"===n.maxHeight||(this.hClone=o.clone().height("auto"),this.clones=this.clones.add(this.hClone)),"original"===n.minWidth&&"original"===n.maxWidth||(this.wClone=t("<div/>").width("auto").css({whiteSpace:"nowrap",float:"left"}),this.clones=this.clones.add(this.wClone)),t.each(e.cloneCSSProperties,function(t,e){i.clones.css(e,o.css(e))}),this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(e.cloneCSSValues).css("overflowY","scroll")},check:function(t,e){var o=this.config,i=this.wClone,n=this.hClone,s=this.el,r=s.val();if(i){i.text(r);var a=i.outerWidth(),l=a+o.extraSpace>=o.minWidth?a+o.extraSpace:o.minWidth,c=s.width();((l=Math.min(l,o.maxWidth))<c&&l>=o.minWidth||l>=o.minWidth&&l<=o.maxWidth)&&(o.onResize.call(s),s.scrollLeft(0),o.animate&&!e?s.stop(1,1).animate({width:l},o.animate):s.width(l))}if(n){l&&n.width(l),n.height(0).val(r).scrollTop(1e4);var h=n[0].scrollTop+o.extraSpace;if(this.previousScrollTop===h)return;this.previousScrollTop=h,h>=o.maxHeight&&(h=o.maxHeight),h<o.minHeight&&(h=o.minHeight),h==o.maxHeight&&l==o.maxWidth?s.css("overflowY","scroll"):s.css("overflowY","hidden"),o.onResize.call(s),o.animate&&!e?s.stop(1,1).animate({height:h},o.animate):s.height(h)}},destroy:function(){this.unbind(),this.el.removeData("AutoResizer"),this.clones.remove(),delete this.el,delete this.hClone,delete this.wClone,delete this.clones},injectClone:function(){(e.cloneContainer||(e.cloneContainer=t("<arclones/>").appendTo("body"))).empty().append(this.clones)}}}(jQuery),function(t){e.SheetClip={parse:function(t){var e,o,i,n,s,r,a,l=[],c=0;for((i=t.split("\n")).length>1&&""===i[i.length-1]&&i.pop(),e=0,o=i.length;e<o;e+=1){for(i[e]=i[e].split("\t"),n=0,s=i[e].length;n<s;n+=1)l[c]||(l[c]=[]),r&&0===n?(a=l[c].length-1,l[c][a]=l[c][a]+"\n"+i[e][0],r&&1&i[e][0].split('"').length-1&&(r=!1,l[c][a]=l[c][a].substring(0,l[c][a].length-1).replace(/""/g,'"'))):n===s-1&&0===i[e][n].indexOf('"')?(l[c].push(i[e][n].substring(1).replace(/""/g,'"')),r=!0):(l[c].push(i[e][n].replace(/""/g,'"')),r=!1);r||(c+=1)}return l},stringify:function(t){var e,o,i,n,s,r="";for(e=0,o=t.length;e<o;e+=1){for(i=0,n=t[e].length;i<n;i+=1)i>0&&(r+="\t"),"string"==typeof(s=t[e][i])?s.indexOf("\n")>-1?r+='"'+s.replace(/"/g,'""')+'"':r+=s:r+=null===s||void 0===s?"":s;r+="\n"}return r}}}();var S,T,E={getInstance:function(){return S?S.hasBeenDestroyed()&&S.init():S=new R,S.refCounter++,S}};function R(){this.refCounter=0,this.init()}R.prototype.init=function(){var t,e,o=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,e=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",(t=this.elDiv.style).position="fixed",t.top=0,t.left=0,e.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",(t=this.elTextarea.style).width="1px",t.height="1px",this.elDiv.appendChild(this.elTextarea),void 0!==t.opacity&&(t.opacity=0)),this.keydownListener=function(t){var e=!1;if(t.metaKey?e=!0:t.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(e=!0),e){if(document.activeElement!==o.elTextarea&&(""!=o.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;o.selectNodeText(o.elTextarea),setTimeout(function(){o.selectNodeText(o.elTextarea)},0)}!e||67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode||(88===t.keyCode?setTimeout(function(){o.triggerCut(t)},0):86===t.keyCode&&setTimeout(function(){o.triggerPaste(t)},0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},R.prototype.selectNodeText=function(t){t.select()},R.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},R.prototype.copyable=function(t){if("string"!=typeof t&&void 0===t.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=t},R.prototype.onCut=function(t){this.cutCallbacks.push(t)},R.prototype.onPaste=function(t){this.pasteCallbacks.push(t)},R.prototype.removeCallback=function(t){var e,o;for(e=0,o=this.copyCallbacks.length;e<o;e++)if(this.copyCallbacks[e]===t)return this.copyCallbacks.splice(e,1),!0;for(e=0,o=this.cutCallbacks.length;e<o;e++)if(this.cutCallbacks[e]===t)return this.cutCallbacks.splice(e,1),!0;for(e=0,o=this.pasteCallbacks.length;e<o;e++)if(this.pasteCallbacks[e]===t)return this.pasteCallbacks.splice(e,1),!0;return!1},R.prototype.triggerCut=function(t){var e=this;e.cutCallbacks&&setTimeout(function(){for(var o=0,i=e.cutCallbacks.length;o<i;o++)e.cutCallbacks[o](t)},50)},R.prototype.triggerPaste=function(t,e){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var i=(e||o.elTextarea.value).replace(/\n$/,""),n=0,s=o.pasteCallbacks.length;n<s;n++)o.pasteCallbacks[n](i,t)},50)},R.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&this.elDiv.parentNode.removeChild(this.elDiv),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},R.prototype.hasBeenDestroyed=function(){return!this.refCounter},R.prototype._bindEvent=e.jQuery?function(e,o,i){t(e).on(o+".copypaste",i)}:function(t,e,o){t.addEventListener(e,o,!1)},R.prototype._unbindEvent=e.jQuery?function(e,o,i){t(e).off(o+".copypaste",i)}:function(t,e,o){t.removeEventListener(e,o,!1)},function(t){var o={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,o){var i={op:"_get",path:this.from};return m(o,[i]),m(o,[{op:"remove",path:this.from}]),m(o,[{op:"add",path:this.path,value:i.value}]),!0},copy:function(t,e,o){var i={op:"_get",path:this.from};return m(o,[i]),m(o,[{op:"add",path:this.path,value:i.value}]),!0},test:function(t,e){return JSON.stringify(t[e])===JSON.stringify(this.value)},_get:function(t,e){this.value=t[e]}},i={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:o.move,copy:o.copy,test:o.test,_get:o._get},n={add:function(t,e){var o={op:"add",path:e+s(this.name),value:this.object[this.name]};t.push(o)},delete:function(t,e){var o={op:"remove",path:e+s(this.name)};t.push(o)},update:function(t,e){var o={op:"replace",path:e+s(this.name),value:this.object[this.name]};t.push(o)}};function s(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function r(t,e){if(t===e)return"/";var o=function t(e,o){var i;for(var n in e)if(e.hasOwnProperty(n)){if(e[n]===o)return s(n)+"/";if("object"==typeof e[n]&&""!=(i=t(e[n],o)))return s(n)+"/"+i}return""}(t,e);if(""===o)throw new Error("Object not found in root");return"/"+o}var a=[];t.intervals;var l,c,h=function(){return function(t){this.observers=[],this.obj=t}}(),u=function(){return function(t,e){this.callback=t,this.observer=e}}();function d(t){for(var e=0,o=a.length;e<o;e++)if(a[e].obj===t)return a[e]}function p(t,e){if(Object.observe){Object.observe(e,t);for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];i&&"object"==typeof i&&p(t,i)}}return t}function f(t,e){if(Object.observe){Object.unobserve(e,t);for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];i&&"object"==typeof i&&f(t,i)}}return t}function g(t){if(Object.observe)Object.deliverChangeRecords(t);else{for(var e,o=0,i=a.length;o<i;o++)if(a[o].obj===t.object){e=a[o];break}!function t(e,o,i,n){var r=l(o);var a=l(e);var c=!1;for(var h=a.length-1;h>=0;h--){var u=a[h],d=e[u];if(o.hasOwnProperty(u)){var p=o[u];d instanceof Object?t(d,p,i,n+"/"+s(u)):d!=p&&(!0,i.push({op:"replace",path:n+"/"+s(u),value:p}),e[u]=p)}else i.push({op:"remove",path:n+"/"+s(u)}),delete e[u],c=!0}if(!c&&r.length==a.length)return;for(var h=0;h<r.length;h++){var u=r[h];e.hasOwnProperty(u)||(i.push({op:"add",path:n+"/"+s(u),value:o[u]}),e[u]=JSON.parse(JSON.stringify(o[u])))}}(e.value,t.object,t.patches,"")}var n=t.patches;return n.length>0&&(t.patches=[],t.callback&&t.callback(n)),n}function m(t,e){for(var n,s=!1,r=0,a=e.length;r<a;){for(var l=(n=e[r]).path.split("/"),h=t,u=1,d=l.length;;)if(c(h)){var p=parseInt(l[u],10);if(++u>=d){s=i[n.op].call(n,h,p,t);break}h=h[p]}else{var f=l[u];if(-1!=f.indexOf("~")&&(f=f.replace(/~1/g,"/").replace(/~0/g,"~")),++u>=d){s=o[n.op].call(n,h,f,t);break}h=h[f]}r++}return s}t.unobserve=function(t,e){g(e),Object.observe?f(e,t):clearTimeout(e.next),function(t,e){for(var o=0,i=t.observers.length;o<i;o++)if(t.observers[o].observer===e)return void t.observers.splice(o,1)}(d(t),e)},t.observe=function(t,o){var i,s=[],l=t,m=d(t);if(m?i=function(t,e){for(var o=0,i=t.observers.length;o<i;o++)if(t.observers[o].callback===e)return t.observers[o].observer}(m,o):(m=new h(t),a.push(m)),i)return i;if(Object.observe)i=function(e){f(i,t),p(i,t);for(var a=0,h=e.length;a<h;){if(("length"!==e[a].name||!c(e[a].object))&&"__Jasmine_been_here_before__"!==e[a].name){var u=e[a].type;switch(u){case"new":u="add";break;case"deleted":u="delete";break;case"updated":u="update"}n[u].call(e[a],s,r(l,e[a].object))}a++}s&&o&&o(s),i.patches=s,s=[]};else if(i={},m.value=JSON.parse(JSON.stringify(t)),o){i.callback=o,i.next=null;var w=this.intervals||[100,1e3,1e4,6e4],y=0,v=function(){g(i)},C=function(){clearTimeout(i.next),i.next=setTimeout(function(){v(),y=0,i.next=setTimeout(b,w[y++])},0)},b=function(){v(),y==w.length&&(y=w.length-1),i.next=setTimeout(b,w[y++])};void 0!==e&&(e.addEventListener?(e.addEventListener("mousedown",C),e.addEventListener("mouseup",C),e.addEventListener("keydown",C)):(e.attachEvent("onmousedown",C),e.attachEvent("onmouseup",C),e.attachEvent("onkeydown",C))),i.next=setTimeout(b,w[y++])}return i.patches=s,i.object=t,m.observers.push(new u(o,i)),p(i,t)},t.generate=g,l=Object.keys?Object.keys:function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(o);return e},c=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=m}(T||(T={})),"undefined"!=typeof exports&&(exports.apply=T.apply,exports.observe=T.observe,exports.unobserve=T.unobserve,exports.generate=T.generate),o.PluginHookClass=function(){var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}},e={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};function i(){this.hooks=t(),this.legacy=e}return i.prototype.add=function(t,i){if(t in e&&(t=e[t]),void 0===this.hooks[t]&&(this.hooks[t]=[]),o.helper.isArray(i))for(var n=0,s=i.length;n<s;n++)this.hooks[t].push(i[n]);else{if(this.hooks[t].indexOf(i)>-1)throw new Error("Seems that you are trying to set the same plugin hook twice ("+t+", "+i+")");this.hooks[t].push(i)}return this},i.prototype.once=function(t,e){if(o.helper.isArray(e))for(var i=0,n=e.length;i<n;i++)e[i].runOnce=!0,this.add(t,e[i]);else e.runOnce=!0,this.add(t,e)},i.prototype.remove=function(t,o){var i=!1;if(t in e&&(t=e[t]),void 0!==this.hooks[t])for(var n=0,s=this.hooks[t].length;n<s;n++)if(this.hooks[t][n]==o){delete this.hooks[t][n].runOnce,this.hooks[t].splice(n,1),i=!0;break}return i},i.prototype.run=function(t,o,i,n,s,r,a){if(o in e&&(o=e[o]),void 0!==this.hooks[o])for(var l=Array.prototype.slice.call(this.hooks[o]),c=0,h=l.length;c<h;c++)l[c].call(t,i,n,s,r,a),l[c].runOnce&&this.remove(o,l[c])},i.prototype.execute=function(t,o,i,n,s,r,a){var l,c;if(o in e&&(o=e[o]),void 0!==this.hooks[o])for(var h=0,u=(c=Array.prototype.slice.call(this.hooks[o])).length;h<u;h++)if(void 0!==(l=c[h].call(t,i,n,s,r,a))&&(i=l),c[h].runOnce&&this.remove(o,c[h]),!1===l)return!1;return i},i}(),o.PluginHooks=new o.PluginHookClass,function(t){var e=new function(){var o=this;this.beforeInit=function(){var t=this;t.autoColumnWidths=[],!1!==t.getSettings().autoColumnSize?t.autoColumnSizeTmp||(t.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},t.addHook("beforeRender",e.determineIfChanged),t.addHook("afterGetColWidth",e.getColWidth),t.addHook("afterDestroy",e.afterDestroy),t.determineColumnWidth=o.determineColumnWidth):t.autoColumnSizeTmp&&(t.removeHook("beforeRender",e.determineIfChanged),t.removeHook("afterGetColWidth",e.getColWidth),t.removeHook("afterDestroy",e.afterDestroy),delete t.determineColumnWidth,o.afterDestroy.call(t))},this.determineIfChanged=function(t){t&&e.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(e){var o=this,i=o.autoColumnSizeTmp;i.container||function(t){var e=document,o=this;o.table=e.createElement("table"),o.theadTh=e.createElement("th"),o.table.appendChild(e.createElement("thead")).appendChild(e.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=e.createElement("tbody"),o.table.appendChild(o.tbody),o.container=e.createElement("div"),o.container.className=t.rootElement[0].className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}.call(i,o),i.container.className=o.rootElement[0].className+" htAutoColumnSize",i.table.className=o.$table[0].className;for(var n=o.countRows(),s={},r=0,a=0;a<n;a++){var l=t.helper.stringify(o.getDataAtCell(a,e)),c=l.length;c>r&&(r=c),s[c]||(s[c]={needed:5,strings:[]}),s[c].needed&&(s[c].strings.push({value:l,row:a}),s[c].needed--)}var h=o.getSettings();h.colHeaders&&o.view.appendColHeader(e,i.theadTh),o.view.wt.wtDom.empty(i.tbody);for(var u in s)if(s.hasOwnProperty(u))for(var d=0,p=s[u].strings.length;d<p;d++){var f=s[u].strings[d].row,g=o.getCellMeta(f,e);g.col=e,g.row=f;var m=o.getCellRenderer(g),w=document.createElement("tr"),y=document.createElement("td");m(o,y,f,e,o.colToProp(e),s[u].strings[d].value,g),a++,w.appendChild(y),i.tbody.appendChild(w)}var v=o.rootElement[0].parentNode;v.appendChild(i.container);var C=o.view.wt.wtDom.outerWidth(i.table);if(v.removeChild(i.container),!h.nativeScrollbars){var b=o.view.wt.wtViewport.getViewportWidth()-2;C>b&&(C=b)}return C},this.determineColumnsWidth=function(){var t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var e=this.countCols(),i=0;i<e;i++)this._getColWidthFromSettings(i)||(this.autoColumnWidths[i]=o.determineColumnWidth.call(this,i))},this.getColWidth=function(t,e){this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e.width&&(e.width=this.autoColumnWidths[t])},this.afterDestroy=function(){var t=this;t.autoColumnSizeTmp&&t.autoColumnSizeTmp.container&&t.autoColumnSizeTmp.container.parentNode&&t.autoColumnSizeTmp.container.parentNode.removeChild(t.autoColumnSizeTmp.container),t.autoColumnSizeTmp=null}};t.PluginHooks.add("beforeInit",e.beforeInit),t.PluginHooks.add("afterUpdateSettings",e.beforeInit)}(o);var x=new function(){var t=this;this.init=function(e){var n,s,r=this,a=r.getSettings().columnSorting;if(r.sortingEnabled=!!a,r.sortingEnabled){r.sortIndex=[];var l=o.call(r);void 0!==l?(n=l.sortColumn,s=l.sortOrder):(n=a.column,s=a.sortOrder),t.sortByColumn.call(r,n,s),r.sort=function(){var e=Array.prototype.slice.call(arguments);return t.sortByColumn.apply(r,e)},void 0===r.getSettings().observeChanges&&function(){var t=this;t.registerTimeout("enableObserveChanges",function(){t.updateSettings({observeChanges:!0})},0)}.call(r),"afterInit"==e&&(i.call(r),r.addHook("afterCreateRow",t.afterCreateRow),r.addHook("afterRemoveRow",t.afterRemoveRow),r.addHook("afterLoadData",t.init))}else delete r.sort,r.removeHook("afterCreateRow",t.afterCreateRow),r.removeHook("afterRemoveRow",t.afterRemoveRow),r.removeHook("afterLoadData",t.init)},this.setSortingColumn=function(t,e){var o=this;if(void 0===t)return delete o.sortColumn,void delete o.sortOrder;o.sortColumn===t&&void 0===e?o.sortOrder=!o.sortOrder:o.sortOrder=void 0===e||e,o.sortColumn=t},this.sortByColumn=function(o,i){var n=this;t.setSortingColumn.call(n,o,i),void 0!==n.sortColumn&&(n.PluginHooks.run("beforeColumnSort",n.sortColumn,n.sortOrder),t.sort.call(n),n.render(),e.call(n),n.PluginHooks.run("afterColumnSort",n.sortColumn,n.sortOrder))};var e=function(){var t=this,e={};void 0!==t.sortColumn&&(e.sortColumn=t.sortColumn),void 0!==t.sortOrder&&(e.sortOrder=t.sortOrder),(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder"))&&t.PluginHooks.run("persistentStateSave","columnSorting",e)},o=function(){var t={};return this.PluginHooks.run("persistentStateLoad","columnSorting",t),t.value},i=function(){var e=this;e.rootElement.on("click.handsontable",".columnSorting",function(o){if(e.view.wt.wtDom.hasClass(o.target,"columnSorting")){var i=(n=o.target,s=e.view.wt.wtDom.closest(n,"TH"),e.view.wt.wtDom.index(s)-e.view.TBODY.querySelector("tr").querySelectorAll("th").length);t.sortByColumn.call(e,i)}var n,s})};function n(t){return function(e,o){return e[1]===o[1]?0:null===e[1]?1:null===o[1]?-1:e[1]<o[1]?t?-1:1:e[1]>o[1]?t?1:-1:0}}function s(t){return function(e,o){if(e[1]===o[1])return 0;if(null===e[1])return 1;if(null===o[1])return-1;var i=new Date(e[1]),n=new Date(o[1]);return i<n?t?-1:1:i>n?t?1:-1:0}}function r(t){return void 0!==t.sortColumn}this.sort=function(){var t=this;if(void 0!==t.sortOrder){t.sortingEnabled=!1,t.sortIndex.length=0;for(var e=this.colOffset(),o=0,i=this.countRows()-t.getSettings().minSpareRows;o<i;o++)this.sortIndex.push([o,t.getDataAtCell(o,this.sortColumn+e)]);var r;switch(t.getCellMeta(0,t.sortColumn).type){case"date":r=s;break;default:r=n}for(this.sortIndex.sort(r(t.sortOrder)),o=this.sortIndex.length;o<t.countRows();o++)this.sortIndex.push([o,t.getDataAtCell(o,this.sortColumn+e)]);t.sortingEnabled=!0}},this.translateRow=function(t){var e=this;return e.sortingEnabled&&e.sortIndex&&e.sortIndex.length&&e.sortIndex[t]?e.sortIndex[t][0]:t},this.onBeforeGetSet=function(e){e.row=t.translateRow.call(this,e.row)},this.untranslateRow=function(t){var e=this;if(e.sortingEnabled&&e.sortIndex&&e.sortIndex.length)for(var o=0;o<e.sortIndex.length;o++)if(e.sortIndex[o][0]==t)return o},this.getColHeader=function(t,e){this.getSettings().columnSorting&&this.view.wt.wtDom.addClass(e.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(t,o){var i=this;if(r(i)){for(var n=0;n<i.sortIndex.length;n++)i.sortIndex[n][0]>=t&&(i.sortIndex[n][0]+=o);for(n=0;n<o;n++)i.sortIndex.splice(t+n,0,[t+n,i.getData()[t+n][i.sortColumn+i.colOffset()]]);e.call(i)}},this.afterRemoveRow=function(o,i){var n=this;if(r(n)){var s=t.translateRow.call(n,o);n.sortIndex.splice(o,i);for(var a=0;a<n.sortIndex.length;a++)n.sortIndex[a][0]>s&&(n.sortIndex[a][0]-=i);e.call(n)}},this.afterChangeSort=function(e){var o=this,i=!1,n={};if(e){for(var s=0;s<e.length;s++)if(e[s][1]==o.sortColumn){i=!0,n.row=t.translateRow.call(o,e[s][0]),n.col=e[s][1];break}i&&setTimeout(function(){t.sort.call(o),o.render(),o.selectCell(t.untranslateRow.call(o,n.row),n.col)},0)}}};o.PluginHooks.add("afterInit",function(){x.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){x.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("beforeGet",x.onBeforeGetSet),o.PluginHooks.add("beforeSet",x.onBeforeGetSet),o.PluginHooks.add("afterGetColHeader",x.getColHeader),function(e){function o(i,n){this.instance=i;var s=this;this.menu=function(){var o=t("body > .htContextMenu")[0];o||(o=document.createElement("DIV"),e.Dom.addClass(o,"htContextMenu"),document.getElementsByTagName("body")[0].appendChild(o));return o}(),this.enabled=!0,this.bindMouseEvents(),this.bindTableEvents(),this.instance.addHook("afterDestroy",function(){s.destroy()}),this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(t,e){this.alter("insert_row",e.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(t,e){this.alter("insert_row",e.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:o.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(t,e){this.alter("insert_col",e.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(t,e){this.alter("insert_col",e.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:o.SEPARATOR,remove_row:{name:"Remove row",callback:function(t,e){var o=e.end.row()-e.start.row()+1;this.alter("remove_row",e.start.row(),o)}},remove_col:{name:"Remove column",callback:function(t,e){var o=e.end.col()-e.start.col()+1;this.alter("remove_col",e.start.col(),o)}},hsep3:o.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},this.options={},e.helper.extend(this.options,this.defaultOptions),this.updateOptions(n)}function i(){var t=this,i=t.getSettings().contextMenu,n=e.helper.isObject(i)?i:{};i?(t.contextMenu||(t.contextMenu=new o(t,n)),t.contextMenu.enable(),e.helper.isArray(i)&&t.contextMenu.filterItems(i)):t.contextMenu&&(t.contextMenu.destroy(),delete t.contextMenu)}o.prototype.bindMouseEvents=function(){this.instance.rootElement.on("contextmenu.htContextMenu",e.helper.proxy(function(i){i.preventDefault(),("TD"==i.target.nodeName||e.Dom.hasClass(i.target,"current")&&e.Dom.hasClass(i.target,"wtBorder"))&&(this.show(i.pageY,i.pageX),t(document).on("mousedown.htContextMenu",e.helper.proxy(o.prototype.close,this)))},this))},o.prototype.bindTableEvents=function(){var t=this;this._afterScrollCallback=function(){t.close()},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},o.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},o.prototype.performAction=function(){var e=t(this.menu).handsontable("getInstance"),i=e.getSelected()[0],n=e.getData()[i];if(!0!==n.disabled&&("function"!=typeof n.disabled||!0!==n.disabled.call(this.instance))&&"function"==typeof n.callback){var s=this.instance.getSelected(),r=o.utils.normalizeSelection(s);n.callback.call(this.instance,n.key,r)}},o.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),t(document).off("mousedown.htContextMenu")},o.prototype.show=function(i,n){this.menu.style.display="block",t(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",e.helper.proxy(this.performAction,this)),t(this.menu).handsontable({data:o.utils.convertItemsToArray(this.getItems()),colHeaders:!1,colWidths:[160],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],beforeKeyDown:e.helper.proxy(this.onBeforeKeyDown,this)}),this.bindTableEvents(),this.setMenuPosition(i,n),t(this.menu).handsontable("listen")},o.prototype.close=function(){this.hide(),t(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},o.prototype.hide=function(){this.menu.style.display="none",t(this.menu).handsontable("destroy")},o.prototype.renderer=function(i,n,s,r,a,l,c){var h,u,d=this,p=i.getData()[s],f=document.createElement("DIV");e.Dom.empty(n),n.appendChild(f),h=p,new RegExp(o.SEPARATOR,"i").test(h.name)?e.Dom.addClass(n,"htSeparator"):e.Dom.fastInnerText(f,l),u=p,d.instance,!0===u.disabled||"function"==typeof u.disabled&&!0===u.disabled.call(d.instance)?(e.Dom.addClass(n,"htDisabled"),t(f).on("mouseenter",function(){i.deselectCell()})):(e.Dom.removeClass(n,"htDisabled"),t(f).on("mouseenter",function(){i.selectCell(s,r)}))},o.prototype.onBeforeKeyDown=function(i){var n,s,r,a,l,c=t(this.menu).handsontable("getInstance"),h=c.getSelected();switch(i.keyCode){case e.helper.keyCode.ESCAPE:this.close(),i.preventDefault(),i.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:c.getSelected()&&(this.performAction(),this.close());break;case e.helper.keyCode.ARROW_DOWN:h?u(h[0],h[1],c):(l=(a=c).getCell(0,0),o.utils.isSeparator(l)||o.utils.isDisabled(l)?u(0,0,a):a.selectCell(0,0)),i.preventDefault(),i.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:h?d(h[0],h[1],c):(s=(n=c).countRows()-1,r=n.getCell(s,0),o.utils.isSeparator(r)||o.utils.isDisabled(r)?d(s,0,n):n.selectCell(s,0)),i.preventDefault(),i.stopImmediatePropagation()}function u(t,e,i){var n=t+1,s=n<i.countRows()?i.getCell(n,e):null;s&&(o.utils.isSeparator(s)||o.utils.isDisabled(s)?u(n,e,i):i.selectCell(n,e))}function d(t,e,i){var n=t-1,s=n>=0?i.getCell(n,e):null;s&&(o.utils.isSeparator(s)||o.utils.isDisabled(s)?d(n,e,i):i.selectCell(n,e))}},o.prototype.getItems=function(){var t={};function o(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}o.prototype=this.options;for(var i in this.options.items)!this.options.items.hasOwnProperty(i)||this.itemsFilter&&-1==this.itemsFilter.indexOf(i)||(t[i]=new o(this.options.items[i]));return t},o.prototype.updateOptions=function(t){if((t=t||{}).items)for(var o in t.items){var i={};t.items.hasOwnProperty(o)&&this.defaultOptions.items.hasOwnProperty(o)&&e.helper.isObject(t.items[o])&&(e.helper.extend(i,this.defaultOptions.items[o]),e.helper.extend(i,t.items[o]),t.items[o]=i)}e.helper.extend(this.options,t)},o.prototype.setMenuPosition=function(t,e){var o={top:t,topRelative:t-document.documentElement.scrollTop,left:e,leftRelative:e-document.documentElement.scrollLeft};this.menuFitsBelowCursor(o)?this.positionMenuBelowCursor(o):this.positionMenuAboveCursor(o),this.menuFitsOnRightOfCursor(o)?this.positionMenuOnRightOfCursor(o):this.positionMenuOnLeftOfCursor(o)},o.prototype.menuFitsBelowCursor=function(t){return t.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight},o.prototype.menuFitsOnRightOfCursor=function(t){return t.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth},o.prototype.positionMenuBelowCursor=function(t){this.menu.style.top=t.top+"px"},o.prototype.positionMenuAboveCursor=function(t){this.menu.style.top=t.top-this.menu.offsetHeight+"px"},o.prototype.positionMenuOnRightOfCursor=function(t){this.menu.style.left=t.left+"px"},o.prototype.positionMenuOnLeftOfCursor=function(t){this.menu.style.left=t.left-this.menu.offsetWidth+"px"},o.utils={},o.utils.convertItemsToArray=function(t){var e,o=[];for(var i in t)if(t.hasOwnProperty(i)){if("string"==typeof t[i])e={name:t[i]};else{if(!1===t[i].visible)continue;e=t[i]}e.key=i,o.push(e)}return o},o.utils.normalizeSelection=function(t){var o={start:new e.SelectionPoint,end:new e.SelectionPoint};return o.start.row(Math.min(t[0],t[2])),o.start.col(Math.min(t[1],t[3])),o.end.row(Math.max(t[0],t[2])),o.end.col(Math.max(t[1],t[3])),o},o.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},o.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},o.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},o.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.close(),this.unbindMouseEvents(),this.unbindTableEvents())},o.prototype.destroy=function(){this.close(),this.unbindMouseEvents(),this.unbindTableEvents(),this.isMenuEnabledByOtherHotInstance()||this.removeMenu()},o.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=t(".handsontable"),o=!1,i=0,n=e.length;i<n;i++){var s=t(e[i]).handsontable("getInstance");if(s&&s.getSettings().contextMenu){o=!0;break}}return o},o.prototype.removeMenu=function(){this.menu.parentNode&&this.menu.parentNode.removeChild(this.menu)},o.prototype.filterItems=function(t){this.itemsFilter=t},o.SEPARATOR="---------",e.PluginHooks.add("afterInit",i),e.PluginHooks.add("afterUpdateSettings",i),e.ContextMenu=o}(o),o.PluginHooks.add("beforeGetCellMeta",function(t,e,o){if(o.isWritable=!o.readOnly,o.autoComplete)throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x")});var D=new function(){var e,o,i,n,s,r=document.createElement("DIV"),a=r.style;r.className="ghost",a.position="absolute",a.top="25px",a.left=0,a.width="10px",a.height="10px",a.backgroundColor="#CCC",a.opacity=.7;var l=function(){this.rootElement.off("mouseup.manualColumnMove"),this.rootElement.off("mousemove.manualColumnMove"),this.rootElement.off("mousedown.manualColumnMove"),this.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(c){if(this.getSettings().manualColumnMove){var h=this.getSettings().manualColumnMove,u=function(){var t={};return this.PluginHooks.run("persistentStateLoad","manualColumnPositions",t),t.value}.call(this);void 0!==u?this.manualColumnPositions=u:h instanceof Array?this.manualColumnPositions=h:this.manualColumnPositions=[],this.forceFullRender=!0,"afterInit"==c&&(function(){var c=this;c.rootElement.on("mousemove.manualColumnMove",function(t){e&&(a.left=s+t.pageX-n+6+"px","none"===a.display&&(a.display="block"))}),c.rootElement.on("mouseup.manualColumnMove",function(){e&&(o<i&&i--,c.getSettings().rowHeaders&&(o--,i--),c.manualColumnPositions.splice(i,0,c.manualColumnPositions.splice(o,1)[0]),t(".manualColumnMover.active").removeClass("active"),e=!1,c.forceFullRender=!0,c.view.render(),a.display="none",function(){this.PluginHooks.run("persistentStateSave","manualColumnPositions",this.manualColumnPositions)}.call(c),c.PluginHooks.run("afterColumnMove",o,i))}),c.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(t){var l=t.currentTarget,h=c.view.wt.wtDom.closest(l,"TH");o=c.view.wt.wtDom.index(h)+c.colOffset(),i=o,e=!0,n=t.pageX;var u=c.$table[0];u.parentNode.appendChild(r),a.width=c.view.wt.wtDom.outerWidth(h)+"px",a.height=c.view.wt.wtDom.outerHeight(u)+"px",s=parseInt(c.view.wt.wtDom.offset(h).left-c.view.wt.wtDom.offset(u).left,10),a.left=s+6+"px"}),c.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(e){var t=c.view.THEAD.querySelector(".manualColumnMover.active");t&&c.view.wt.wtDom.removeClass(t,"active"),i=c.view.wt.wtDom.index(this)+c.colOffset();var o=c.view.THEAD.querySelectorAll("th")[i].querySelector(".manualColumnMover");c.view.wt.wtDom.addClass(o,"active")}}),c.addHook("afterDestroy",l)}.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else l.call(this),this.manualColumnPositions=[]},this.modifyCol=function(t){return this.getSettings().manualColumnMove?(void 0===this.manualColumnPositions[t]&&(this.manualColumnPositions[t]=t),this.manualColumnPositions[t]):t},this.getColHeader=function(t,e){if(this.getSettings().manualColumnMove){var o=document.createElement("DIV");o.className="manualColumnMover",e.firstChild.appendChild(o)}}};o.PluginHooks.add("beforeInit",D.beforeInit),o.PluginHooks.add("afterInit",function(){D.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){D.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("afterGetColHeader",D.getColHeader),o.PluginHooks.add("modifyCol",D.modifyCol);var H,k=new function(){var e,o,i,n,s,r,a,l,c,h=document.createElement("DIV"),u=document.createElement("DIV"),d=document.createElement("DIV"),p=d.style;h.className="manualColumnResizer",u.className="manualColumnResizerHandle",h.appendChild(u),d.className="manualColumnResizerLine",h.appendChild(d);var f=t(document);f.mousemove(function(t){e&&(n=l+(t.pageX-a),r=y(i,n),h.style.left=c+n+"px")}),f.mouseup(function(){e&&(s.view.wt.wtDom.removeClass(h,"active"),e=!1,r!=l&&(s.forceFullRender=!0,s.view.render(),g.call(s),s.PluginHooks.run("afterColumnResize",i,r)),m.call(s,o))});var g=function(){this.PluginHooks.run("persistentStateSave","manualColumnWidths",this.manualColumnWidths)};function m(t){s=this,o=t;var e=this.view.wt.wtTable.getCoords(t)[1];if(e>=0){i=e;var n=this.view.wt.wtDom.offset(this.rootElement[0]).left,r=this.view.wt.wtDom.offset(t).left;c=r-n-6,h.style.left=c+parseInt(this.view.wt.wtDom.outerWidth(t),10)+"px",this.rootElement[0].appendChild(h)}}var w=function(){var t=this,n=0,s=null;this.rootElement.on("mouseenter.handsontable","th",function(o){e||m.call(t,o.currentTarget)}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){null==s&&(s=setTimeout(function(){n>=2&&(r=t.determineColumnWidth.call(t,i),y(i,r),t.forceFullRender=!0,t.view.render(),t.PluginHooks.run("afterColumnResize",i,r)),n=0,s=null},500)),n++}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(i){a=i.pageX,function(){l=parseInt(this.view.wt.wtDom.outerWidth(o),10),this.view.wt.wtDom.addClass(h,"active"),p.height=this.view.wt.wtDom.outerHeight(this.$table[0])+"px",e=this}.call(t),r=l})};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(t){if(this.getSettings().manualColumnResize){var e=this.getSettings().manualColumnResize,o=function(){var t={};return this.PluginHooks.run("persistentStateLoad","manualColumnWidths",t),t.value}.call(this);void 0!==o?this.manualColumnWidths=o:e instanceof Array?this.manualColumnWidths=e:this.manualColumnWidths=[],"afterInit"==t&&(w.call(this),this.forceFullRender=!0,this.render())}};var y=function(t,e){return e=Math.max(e,20),t=s.PluginHooks.execute("modifyCol",t),s.manualColumnWidths[t]=e,e};this.getColWidth=function(t,e){this.getSettings().manualColumnResize&&this.manualColumnWidths[t]&&(e.width=this.manualColumnWidths[t])}};function A(){this.boundaries=null,this.callback=null}o.PluginHooks.add("beforeInit",k.beforeInit),o.PluginHooks.add("afterInit",function(){k.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){k.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("afterGetColWidth",k.getColWidth),function(){function t(){var t=this,o=t.getSettings().observeChanges;o?(t.observer&&e.call(t),function(){var t=this;t.observeChangesActive=!0,t.pauseObservingChanges=function(){t.observeChangesActive=!1},t.resumeObservingChanges=function(){t.observeChangesActive=!0},t.observedData=t.getData(),t.observer=T.observe(t.observedData,function(e){t.observeChangesActive&&(function(t){for(var e=this,o=function(t){return i=t,e=i.filter(function(t){return!/[/]length/gi.test(t.path)}),o=[],e.filter(function(t){var e=a(t.path);if(-1!=["add","remove"].indexOf(t.op)&&!isNaN(e.col)){if(-1!=o.indexOf(e.col))return!1;o.push(e.col)}return!0});var e,o;var i}(t),i=0,n=o.length;i<n;i++){var s=o[i],r=a(s.path);switch(s.op){case"add":isNaN(r.col)?e.runHooks("afterCreateRow",r.row):e.runHooks("afterCreateCol",r.col);break;case"remove":isNaN(r.col)?e.runHooks("afterRemoveRow",r.row,1):e.runHooks("afterRemoveCol",r.col,1);break;case"replace":e.runHooks("afterChange",[r.row,r.col,null,s.value],"external")}}function a(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(e[1],10),col:/^\d*$/.test(e[2])?parseInt(e[2],10):e[2]}}}.call(t,e),t.render()),t.runHooks("afterChangesObserved")})}.call(t),function(){var t=this;t.addHook("afterDestroy",e),t.addHook("afterCreateRow",i),t.addHook("afterRemoveRow",i),t.addHook("afterCreateCol",i),t.addHook("afterRemoveCol",i),t.addHook("afterChange",function(t,e){"loadData"!=e&&i.call(this)})}.call(t)):o||e.call(t)}function e(){this.observer&&(function(){var t=this;T.unobserve(t.observedData,t.observer),delete t.observeChangesActive,delete t.pauseObservingChanges,delete t.resumeObservingChanges}.call(this),function(){var t=this;t.removeHook("afterDestroy",e),t.removeHook("afterCreateRow",i),t.removeHook("afterRemoveRow",i),t.removeHook("afterCreateCol",i),t.removeHook("afterRemoveCol",i),t.removeHook("afterChange",i)}.call(this))}function i(){var t=this;t.pauseObservingChanges(),t.addHookOnce("afterChangesObserved",function(){t.resumeObservingChanges()})}o.PluginHooks.add("afterLoadData",t),o.PluginHooks.add("afterUpdateSettings",t)}(),function(t){var e=new function(){var e=this;this.init=function(){var n=this,s=n.getSettings().persistentState;e.enabled=!!s,e.enabled?(n.storage||(n.storage=new t(n.rootElement[0].id)),n.resetState=e.resetValue,function(){for(var t in o)o.hasOwnProperty(t)&&!i.call(this,t)&&this.PluginHooks.add(t,o[t])}.call(n)):function(){for(var t in o)o.hasOwnProperty(t)&&i.call(this,t)&&this.PluginHooks.remove(t,o[t])}.call(n)},this.saveValue=function(t,e){this.storage.saveValue(t,e)},this.loadValue=function(t,e){e.value=this.storage.loadValue(t)},this.resetValue=function(t){void 0!==t?this.storage.reset(t):this.storage.resetAll()};var o={persistentStateSave:e.saveValue,persistentStateLoad:e.loadValue,persistentStateReset:e.resetValue};function i(t){return this.PluginHooks.hooks.hasOwnProperty(t)}};o.PluginHooks.add("beforeInit",e.init),o.PluginHooks.add("afterUpdateSettings",e.init)}(function(t){var o,i,n,s=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(o)};i=e.localStorage[t+"__persistentStateKeys"],n="string"==typeof i?JSON.parse(i):void 0,o=n||[],this.saveValue=function(i,n){e.localStorage[t+"_"+i]=JSON.stringify(n),-1==o.indexOf(i)&&(o.push(i),s())},this.loadValue=function(o,i){o=void 0!==o?o:i;var n=e.localStorage[t+"_"+o];return void 0===n?void 0:JSON.parse(n)},this.reset=function(o){e.localStorage.removeItem(t+"_"+o)},this.resetAll=function(){for(var i=0;i<o.length;i++)e.localStorage.removeItem(t+"_"+o[i]);o=[],s()}}),(H=o).UndoRedo=function(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,o){if(t){var i=new H.UndoRedo.ChangeAction(t);e.done(i)}}),t.addHook("afterCreateRow",function(t,o){var i=new H.UndoRedo.CreateRowAction(t,o);e.done(i)}),t.addHook("beforeRemoveRow",function(t,o){var i=e.instance.getData();t=(i.length+t)%i.length;var n=i.slice(t,t+o),s=new H.UndoRedo.RemoveRowAction(t,n);e.done(s)}),t.addHook("afterCreateCol",function(t,o){var i=new H.UndoRedo.CreateColumnAction(t,o);e.done(i)}),t.addHook("beforeRemoveCol",function(o,i){var n=e.instance.getData();o=(e.instance.countCols()+o)%e.instance.countCols();for(var s,r=[],a=0,l=n.length;a<l;a++)r[a]=n[a].slice(o,o+i);H.helper.isArray(t.getSettings().colHeaders)&&(s=t.getSettings().colHeaders.slice(o,o+r.length));var c=new H.UndoRedo.RemoveColumnAction(o,r,s);e.done(c)})},H.UndoRedo.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},H.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop();this.ignoreNewActions=!0,t.undo(this.instance),this.ignoreNewActions=!1,this.undoneActions.push(t)}},H.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop();this.ignoreNewActions=!0,t.redo(this.instance),this.ignoreNewActions=!0,this.doneActions.push(t)}},H.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},H.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},H.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},H.UndoRedo.Action=function(){},H.UndoRedo.Action.prototype.undo=function(){},H.UndoRedo.Action.prototype.redo=function(){},H.UndoRedo.ChangeAction=function(t){this.changes=t},H.helper.inherit(H.UndoRedo.ChangeAction,H.UndoRedo.Action),H.UndoRedo.ChangeAction.prototype.undo=function(e){for(var o=t.extend(!0,[],this.changes),i=0,n=o.length;i<n;i++)o[i].splice(3,1);e.setDataAtRowProp(o,null,null,"undo")},H.UndoRedo.ChangeAction.prototype.redo=function(e){for(var o=t.extend(!0,[],this.changes),i=0,n=o.length;i<n;i++)o[i].splice(2,1);e.setDataAtRowProp(o,null,null,"redo")},H.UndoRedo.CreateRowAction=function(t,e){this.index=t,this.amount=e},H.helper.inherit(H.UndoRedo.CreateRowAction,H.UndoRedo.Action),H.UndoRedo.CreateRowAction.prototype.undo=function(t){t.alter("remove_row",this.index,this.amount)},H.UndoRedo.CreateRowAction.prototype.redo=function(t){t.alter("insert_row",this.index+1,this.amount)},H.UndoRedo.RemoveRowAction=function(t,e){this.index=t,this.data=e},H.helper.inherit(H.UndoRedo.RemoveRowAction,H.UndoRedo.Action),H.UndoRedo.RemoveRowAction.prototype.undo=function(t){var e=[this.index,0];Array.prototype.push.apply(e,this.data),Array.prototype.splice.apply(t.getData(),e),t.render()},H.UndoRedo.RemoveRowAction.prototype.redo=function(t){t.alter("remove_row",this.index,this.data.length)},H.UndoRedo.CreateColumnAction=function(t,e){this.index=t,this.amount=e},H.helper.inherit(H.UndoRedo.CreateColumnAction,H.UndoRedo.Action),H.UndoRedo.CreateColumnAction.prototype.undo=function(t){t.alter("remove_col",this.index,this.amount)},H.UndoRedo.CreateColumnAction.prototype.redo=function(t){t.alter("insert_col",this.index+1,this.amount)},H.UndoRedo.RemoveColumnAction=function(t,e,o){this.index=t,this.data=e,this.amount=this.data[0].length,this.headers=o},H.helper.inherit(H.UndoRedo.RemoveColumnAction,H.UndoRedo.Action),H.UndoRedo.RemoveColumnAction.prototype.undo=function(t){for(var e,o,i=0,n=t.getData().length;i<n;i++)e=t.getDataAtRow(i),o=[this.index,0],Array.prototype.push.apply(o,this.data[i]),Array.prototype.splice.apply(e,o);void 0!==this.headers&&(o=[this.index,0],Array.prototype.push.apply(o,this.headers),Array.prototype.splice.apply(t.getSettings().colHeaders,o)),t.render()},H.UndoRedo.RemoveColumnAction.prototype.redo=function(t){t.alter("remove_col",this.index,this.amount)},function(t){function e(){var e,n,s=this;void 0===s.getSettings().undo||s.getSettings().undo?s.undoRedo||(s.undoRedo=new t.UndoRedo(s),(n=s).undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()},s.addHook("beforeKeyDown",o),s.addHook("afterChange",i)):s.undoRedo&&(delete s.undoRedo,delete(e=s).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,s.removeHook("beforeKeyDown",o),s.removeHook("afterChange",i))}function o(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&(89===t.keyCode||t.shiftKey&&90===t.keyCode?(this.undoRedo.redo(),t.stopImmediatePropagation()):90===t.keyCode&&(this.undoRedo.undo(),t.stopImmediatePropagation()))}function i(t,e){if("loadData"==e)return this.undoRedo.clear()}t.PluginHooks.add("afterInit",e),t.PluginHooks.add("afterUpdateSettings",e)}(o),A.prototype.setBoundaries=function(t){this.boundaries=t},A.prototype.setCallback=function(t){this.callback=t},A.prototype.check=function(t,e){var o=0,i=0;e<this.boundaries.top?i=e-this.boundaries.top:e>this.boundaries.bottom&&(i=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,i)};var P,O,N,M=!1;if(void 0!==o){var V=function(t){var o=t.view.wt.wtScrollbars.vertical.scrollHandler;P=new A,o!==e&&(o?P.setBoundaries(o.getBoundingClientRect()):P.setBoundaries(t.$table[0].getBoundingClientRect()),P.setCallback(function(e,i){e<0?o?o.scrollLeft-=50:t.view.wt.scrollHorizontal(-1).draw():e>0&&(o?o.scrollLeft+=50:t.view.wt.scrollHorizontal(1).draw()),i<0?o?o.scrollTop-=20:t.view.wt.scrollVertical(-1).draw():i>0&&(o?o.scrollTop+=20:t.view.wt.scrollVertical(1).draw())}),M=!0)};o.PluginHooks.add("afterInit",function(){t(document).on("mouseup."+this.guid,function(){M=!1}),t(document).on("mousemove."+this.guid,function(t){M&&P.check(t.clientX,t.clientY)})}),o.PluginHooks.add("destroy",function(){t(document).off("."+this.guid)}),o.PluginHooks.add("afterOnCellMouseDown",function(){V(this)}),o.PluginHooks.add("afterOnCellCornerMouseDown",function(){V(this)})}function I(){this.maxOuts=10}function L(e,o){var i;this.instance=e,this.settings=o,this.wtDom=this.instance.wtDom,this.main=document.createElement("div"),(i=this.main.style).position="absolute",i.top=0,i.left=0;for(var n=0;n<5;n++){var s=document.createElement("DIV");s.className="wtBorder "+(o.className||""),(i=s.style).backgroundColor=o.border.color,i.height=o.border.width+"px",i.width=o.border.width+"px",this.main.appendChild(s)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.appendChild(this.main);var r=!1,a=t(document.body);a.on("mousedown.walkontable."+e.guid,function(){r=!0}),a.on("mouseup.walkontable."+e.guid,function(){r=!1}),t(this.main.childNodes).on("mouseenter",function(o){if(r&&e.getSetting("hideBorderOnMouseDownOver")){o.preventDefault(),o.stopImmediatePropagation();var i=this.getBoundingClientRect(),n=t(this);n.hide();a.on("mousemove.border."+e.guid,function(t){var o;((o=t).clientY<Math.floor(i.top)||o.clientY>Math.ceil(i.top+i.height)||o.clientX<Math.floor(i.left)||o.clientX>Math.ceil(i.left+i.width))&&(a.off("mousemove.border."+e.guid),n.show())})}})}function B(){this.offset=0,this.total=0,this.fixedCount=0}function W(t){this.instance=t}function _(){this.cache=[]}function z(){this.countTH=0}function F(t,e,o,i){var n,s=0;for(W.apply(this,arguments),this.containerSizeFn=e,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.remainingSize=0,this.strategy=i;void 0!==(n=o(s))&&!(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+n));)this.cellSizes.push(n),this.cellSizesSum+=n,this.cellCount++,s++;var r=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-r}function j(e){var o=this,i=[];if(this.guid="wt_"+K(),this.wtDom=new $,e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new at(this,e.table),this.wtScroll=new Q(this),this.wtViewport=e.cloneSource.wtViewport):(this.wtSettings=new rt(this,e),this.wtTable=new at(this,e.table),this.wtScroll=new Q(this),this.wtViewport=new lt(this),this.wtScrollbars=new nt(this),this.wtWheel=new function(e){if(e.getSetting("nativeScrollbars"))return;t(e.wtTable.spreader).on("mousewheel",function(t,o,i,n){i||n||!o||(n=o),(i||n)&&(n>0&&0===e.getSetting("offsetRow")||n<0&&e.wtTable.isLastRowFullyVisible()||i<0&&0===e.getSetting("offsetColumn")||i>0&&e.wtTable.isLastColumnFullyVisible()||(clearTimeout(e.wheelTimeout),e.wheelTimeout=setTimeout(function(){n?e.wtScrollbars.vertical.visible&&e.scrollVertical(-Math.ceil(n)).draw():i&&e.wtScrollbars.horizontal.visible&&e.scrollHorizontal(Math.ceil(i)).draw()},0),t.preventDefault()))})}(this),this.wtEvent=new G(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,s=this.wtTable.THEAD.childNodes[0].childNodes.length;n<s;n++)i.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,e){o.wtDom.fastInnerText(e,i[t])}])}this.selections={};var r=this.getSetting("selections");if(r)for(var a in r)r.hasOwnProperty(a)&&(this.selections[a]=new st(this,r[a]));this.drawn=!1,this.drawInterrupted=!1}function U(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var o,i=this,n=0,s=0,r=i.clone.wtTable.holder.parentNode;t(document.body).on("mousemove."+this.instance.guid,function(t){i.instance.wtTable.holder.parentNode&&(t.clientX-n>-5&&t.clientX-n<5&&t.clientY-s>-5&&t.clientY-s<5||(n=t.clientX,s=t.clientY,$.prototype.addClass(r,"wtDebugHidden"),$.prototype.removeClass(r,"wtDebugVisible"),clearTimeout(o),o=setTimeout(function(){$.prototype.removeClass(r,"wtDebugHidden"),$.prototype.addClass(r,"wtDebugVisible")},1e3)))})}function $(){}function G(e){var o=this;this.instance=e,this.wtDom=this.instance.wtDom;var i,n=[null,null],s=[null,null];t(this.instance.wtTable.holder).on("mousedown",function(t){var e=o.parentCell(t.target);o.wtDom.hasClass(t.target,"corner")?o.instance.getSetting("onCellCornerMouseDown",t,t.target):e.TD&&"TD"===e.TD.nodeName&&o.instance.hasSetting("onCellMouseDown")&&o.instance.getSetting("onCellMouseDown",t,e.coords,e.TD),2!==t.button&&e.TD&&"TD"===e.TD.nodeName&&(n[0]=e.TD,clearTimeout(s[0]),s[0]=setTimeout(function(){n[0]=null},1e3))}),t(this.instance.wtTable.TABLE).on("mouseover",function(t){if(o.instance.hasSetting("onCellMouseOver")){var e=o.instance.wtTable.TABLE,n=o.wtDom.closest(t.target,["TD","TH"],e);n&&n!==i&&o.wtDom.isChildOf(n,e)&&(i=n,"TD"===n.nodeName&&o.instance.getSetting("onCellMouseOver",t,o.instance.wtTable.getCoords(n),n))}}),t(this.instance.wtTable.holder).on("mouseup",function(t){if(2!==t.button){var e=o.parentCell(t.target);e.TD===n[0]&&e.TD===n[1]?(o.wtDom.hasClass(t.target,"corner")?o.instance.getSetting("onCellCornerDblClick",t,e.coords,e.TD):e.TD&&o.instance.getSetting("onCellDblClick",t,e.coords,e.TD),n[0]=null,n[1]=null):e.TD===n[0]&&(n[1]=e.TD,clearTimeout(s[1]),s[1]=setTimeout(function(){n[1]=null},500))}})}function K(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}if(function(t,e,o){function i(){var i=this,n=!1!==i.getSettings().copyPaste;n&&!i.copyPaste?i.copyPaste=new function(i){this.copyPasteInstance=e.getInstance(),this.copyPasteInstance.onCut(s),this.copyPasteInstance.onPaste(r);var n=this;function s(){i.isListening()&&i.selection.empty()}function r(t){if(i.isListening()&&i.selection.isSelected()){var e=t.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),n=o.parse(e),s=i.getSelected(),r=i.getCornerCoords([{row:s[0],col:s[1]},{row:s[2],col:s[3]}]),a=r.TL,l={row:Math.max(r.BR.row,n.length-1+r.TL.row),col:Math.max(r.BR.col,n[0].length-1+r.TL.col)};i.PluginHooks.once("afterChange",function(t,e){t&&t.length&&this.selectCell(a.row,a.col,l.row,l.col)}),i.populateFromArray(a.row,a.col,n,l.row,l.col,"paste",i.getSettings().pasteMode)}}function a(e){if(t.helper.isCtrlKey(e.keyCode)&&i.getSelected())return n.setCopyableText(),void e.stopImmediatePropagation();var o=(e.ctrlKey||e.metaKey)&&!e.altKey;e.keyCode==t.helper.keyCode.A&&o&&setTimeout(t.helper.proxy(n.setCopyableText,n))}i.addHook("beforeKeyDown",a),this.destroy=function(){this.copyPasteInstance.removeCallback(s),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),i.removeHook("beforeKeyDown",a)},i.addHook("afterDestroy",t.helper.proxy(this.destroy,this)),this.triggerPaste=t.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=t.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=i.getSelected(),e=i.getSettings(),o=e.copyRowsLimit,n=e.copyColsLimit,s=Math.min(t[0],t[2]),r=Math.min(t[1],t[3]),a=Math.max(t[0],t[2]),l=Math.max(t[1],t[3]),c=Math.min(a,s+o-1),h=Math.min(l,r+n-1);i.copyPaste.copyPasteInstance.copyable(i.getCopyableData(s,r,c,h)),a===c&&l===h||i.PluginHooks.run("afterCopyLimit",a-s+1,l-r+1,o,n)}}(i):!n&&i.copyPaste&&(i.copyPaste.destroy(),delete i.copyPaste)}t.PluginHooks.add("afterInit",i),t.PluginHooks.add("afterUpdateSettings",i)}(o,E,SheetClip),I.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.fixed.style.position="absolute",this.fixed.style.left="0",this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=t(this.scrollHandler)},I.prototype.makeClone=function(t){var e=document.createElement("DIV");e.className="ht_clone_"+t+" handsontable",e.style.position="fixed",e.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,e.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(e),new j({cloneSource:this.instance,cloneOverlay:this,table:o})},I.prototype.getScrollableElement=function(t){for(var o=t.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof ot&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return e},I.prototype.prepare=function(){},I.prototype.onScroll=function(t){this.windowScrollPosition=this.getScrollPosition(),this.readSettings(),t&&(this.windowScrollPosition=t),this.resetFixedPosition()},I.prototype.availableSize=function(){return this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?this.instance.wtDom.outerHeight(this.TABLE):this.windowSize:this.windowSize-this.tableParentOffset},I.prototype.refresh=function(t){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),this.measureAfter=-1===e?0:this.sumCellSizes(e,this.total-e),this.applyToDOM(),this.clone&&this.clone.draw(t)},I.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid),t(e).off("."+this.instance.guid),t(document).off("."+this.instance.guid)},L.prototype.appear=function(t){var e,o,i,n,s,r,a,l,c,h,u,d;if(!this.disabled){var p,f,g,m,w,y,v,C=this.instance,b=!1,S=!1,T=!1,E=!1;for(C.wtTable.isRowInViewport(t[0])||(b=!0),C.wtTable.isRowInViewport(t[2])||(T=!0),y=C.wtTable.rowStrategy.countVisible(),w=0;w<y;w++)if((v=C.wtTable.rowFilter.visibleToSource(w))>=t[0]&&v<=t[2]){p=v;break}for(w=y-1;w>=0;w--)if((v=C.wtTable.rowFilter.visibleToSource(w))>=t[0]&&v<=t[2]){g=v;break}if(b&&T)S=!0,E=!0;else{for(C.wtTable.isColumnInViewport(t[1])||(S=!0),C.wtTable.isColumnInViewport(t[3])||(E=!0),y=C.wtTable.columnStrategy.countVisible(),w=0;w<y;w++)if((v=C.wtTable.columnFilter.visibleToSource(w))>=t[1]&&v<=t[3]){f=v;break}for(w=y-1;w>=0;w--)if((v=C.wtTable.columnFilter.visibleToSource(w))>=t[1]&&v<=t[3]){m=v;break}}if(void 0!==p&&void 0!==f){e=p!==g||f!==m,o=C.wtTable.getCell([p,f]),i=e?C.wtTable.getCell([g,m]):o,n=this.wtDom.offset(o),s=e?this.wtDom.offset(i):n,r=this.wtDom.offset(C.wtTable.TABLE),l=n.top,u=s.top+this.wtDom.outerHeight(i)-l,h=n.left,d=s.left+this.wtDom.outerWidth(i)-h,a=l-r.top-1,c=h-r.left-1;var R=this.wtDom.getComputedStyle(o);parseInt(R.borderTopWidth,10)>0&&(a+=1,u=u>0?u-1:0),parseInt(R.borderLeftWidth,10)>0&&(c+=1,d=d>0?d-1:0),b?this.topStyle.display="none":(this.topStyle.top=a+"px",this.topStyle.left=c+"px",this.topStyle.width=d+"px",this.topStyle.display="block"),S?this.leftStyle.display="none":(this.leftStyle.top=a+"px",this.leftStyle.left=c+"px",this.leftStyle.height=u+"px",this.leftStyle.display="block");var x=Math.floor(this.settings.border.width/2);T?this.bottomStyle.display="none":(this.bottomStyle.top=a+u-x+"px",this.bottomStyle.left=c+"px",this.bottomStyle.width=d+"px",this.bottomStyle.display="block"),E?this.rightStyle.display="none":(this.rightStyle.top=a+"px",this.rightStyle.left=c+d-x+"px",this.rightStyle.height=u+1+"px",this.rightStyle.display="block"),T||E||!this.hasSetting(this.settings.border.cornerVisible)?this.cornerStyle.display="none":(this.cornerStyle.top=a+u-4+"px",this.cornerStyle.left=c+d-4+"px",this.cornerStyle.display="block")}else this.disappear()}},L.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},L.prototype.hasSetting=function(t){return"function"==typeof t?t():!!t},B.prototype.source=function(t){return t},B.prototype.offsetted=function(t){return t+this.offset},B.prototype.unOffsetted=function(t){return t-this.offset},B.prototype.fixed=function(t){return t<this.fixedCount?t-this.offset:t},B.prototype.unFixed=function(t){return t<this.fixedCount?t+this.offset:t},B.prototype.visibleToSource=function(t){return this.source(this.offsetted(this.fixed(t)))},B.prototype.sourceToVisible=function(t){return this.source(this.unOffsetted(this.unFixed(t)))},W.prototype.getSize=function(t){return this.cellSizes[t]},W.prototype.getContainerSize=function(t){return"function"==typeof this.containerSizeFn?this.containerSizeFn(t):this.containerSizeFn},W.prototype.countVisible=function(){return this.cellCount},W.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var t=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>t.sumCellSizes(t.offset,t.offset+t.curOuts+1)}return this.remainingSize>0},_.prototype.add=function(t,e,o){this.cache[t]||(this.cache[t]=[]),this.cache[t][e]||(this.cache[t][e]=[]),this.cache[t][e][o]=!0},_.prototype.test=function(t,e,o){return this.cache[t]&&this.cache[t][e]&&this.cache[t][e][o]},z.prototype=new B,z.prototype.readSettings=function(t){this.offset=t.wtSettings.settings.offsetColumn,this.total=t.getSetting("totalColumns"),this.fixedCount=t.getSetting("fixedColumnsLeft"),this.countTH=t.getSetting("rowHeaders").length},z.prototype.offsettedTH=function(t){return t-this.countTH},z.prototype.unOffsettedTH=function(t){return t+this.countTH},z.prototype.visibleRowHeadedColumnToSourceColumn=function(t){return this.visibleToSource(this.offsettedTH(t))},z.prototype.sourceColumnToVisibleRowHeadedColumn=function(t){return this.unOffsettedTH(this.sourceToVisible(t))},F.prototype=new W,F.prototype.getSize=function(t){return this.cellSizes[t]+(this.cellStretch[t]||0)},F.prototype.stretch=function(){var t=this.getContainerSize(this.cellSizesSum),e=0;if(this.remainingSize=this.cellSizesSum-t,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,i=t/this.cellSizesSum;e<this.cellCount-1;)o=Math.floor(i*this.cellSizes[e]),this.remainingSize+=o-this.cellSizes[e],this.cellStretch[e]=o-this.cellSizes[e],e++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&t!==1/0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},j.prototype.draw=function(t){if(this.drawInterrupted=!1,t||this.wtDom.isVisible(this.wtTable.TABLE))return this.getSetting("beforeDraw",!t),t=t&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn,this.drawn&&(this.scrollVertical(0),this.scrollHorizontal(0)),this.lastOffsetRow=this.getSetting("offsetRow"),this.lastOffsetColumn=this.getSetting("offsetColumn"),this.wtTable.draw(t),this.cloneSource||this.getSetting("onDraw",!t),this;this.drawInterrupted=!0},j.prototype.update=function(t,e){return this.wtSettings.update(t,e)},j.prototype.scrollVertical=function(t){var e=this.wtScroll.scrollVertical(t);return this.getSetting("onScrollVertically"),e},j.prototype.scrollHorizontal=function(t){var e=this.wtScroll.scrollHorizontal(t);return this.getSetting("onScrollHorizontally"),e},j.prototype.scrollViewport=function(t){return this.wtScroll.scrollViewport(t),this},j.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},j.prototype.getSetting=function(t,e,o,i){return this.wtSettings.getSetting(t,e,o,i)},j.prototype.hasSetting=function(t){return this.wtSettings.has(t)},j.prototype.destroy=function(){t(document.body).off("."+this.guid),this.wtScrollbars.destroy(),clearTimeout(this.wheelTimeout),this.wtEvent&&this.wtEvent.destroy()},U.prototype=new I,U.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=this.instance.wtTable.holder.getBoundingClientRect();t.style.top=Math.ceil(e.top,10)+"px",t.style.left=Math.ceil(e.left,10)+"px"}},U.prototype.prepare=function(){},U.prototype.refresh=function(t){this.clone&&this.clone.draw(t)},U.prototype.getScrollPosition=function(){},U.prototype.getLastCell=function(){},U.prototype.applyToDOM=function(){},U.prototype.scrollTo=function(){},U.prototype.readWindowSize=function(){},U.prototype.readSettings=function(){},$.prototype.closest=function(t,e,o){for(;null!=t&&t!==o;){if(1===t.nodeType&&e.indexOf(t.nodeName)>-1)return t;t=t.parentNode}return null},$.prototype.isChildOf=function(t,e){for(var o=t.parentNode;null!=o;){if(o==e)return!0;o=o.parentNode}return!1},$.prototype.index=function(t){for(var e=0;t=t.previousSibling;)++e;return e},document.documentElement.classList?($.prototype.hasClass=function(t,e){return t.classList.contains(e)},$.prototype.addClass=function(t,e){t.classList.add(e)},$.prototype.removeClass=function(t,e){t.classList.remove(e)}):($.prototype.hasClass=function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},$.prototype.addClass=function(t,e){this.hasClass(t,e)||(t.className+=" "+e)},$.prototype.removeClass=function(t,e){if(this.hasClass(t,e)){var o=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(o," ").trim()}}),$.prototype.removeTextNodes=function(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var o=t.childNodes,i=o.length-1;i>=0;i--)this.removeTextNodes(o[i],t)},$.prototype.empty=function(t){for(var e;e=t.lastChild;)t.removeChild(e)},$.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,$.prototype.fastInnerHTML=function(t,e){this.HTML_CHARACTERS.test(e)?t.innerHTML=e:this.fastInnerText(t,e)},document.createTextNode("test").textContent?$.prototype.fastInnerText=function(t,e){var o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(this.empty(t),t.appendChild(document.createTextNode(e)))}:$.prototype.fastInnerText=function(t,e){var o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=e:(this.empty(t),t.appendChild(document.createTextNode(e)))},$.prototype.isVisible=function(t){for(var e=t;e!==document.documentElement;){if(null===e)return!1;if(11===e.nodeType){if(e.host){if(e.host.impl)return $.prototype.isVisible(e.host.impl);if(e.host)return $.prototype.isVisible(e.host);throw new Error("Lost in Web Components world")}return!1}if("none"===e.style.display)return!1;e=e.parentNode}return!0},$.prototype.offset=function(t){if(this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName){var o=t.getBoundingClientRect();return{top:o.top+(e.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:o.left+(e.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var i=t.offsetLeft,n=t.offsetTop,s=t;(t=t.offsetParent)&&t!==document.body;)i+=t.offsetLeft,n+=t.offsetTop,s=t;return s&&"fixed"===s.style.position&&(i+=e.pageXOffset||document.documentElement.scrollLeft,n+=e.pageYOffset||document.documentElement.scrollTop),{left:i,top:n}},$.prototype.getComputedStyle=function(t){return t.currentStyle||document.defaultView.getComputedStyle(t)},$.prototype.outerWidth=function(t){return t.offsetWidth},$.prototype.outerHeight=function(t){return this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight},function(){var t,e;$.prototype.hasCaptionProblem=function(){return void 0===t&&function(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var o=document.createElement("TBODY");e.appendChild(o),o.appendChild(document.createElement("TR")),o.firstChild.appendChild(document.createElement("TD")),o.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c",i.style.padding=0,i.style.margin=0,e.insertBefore(i,o),document.body.appendChild(e),t=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),t},$.prototype.getCaretPosition=function(t){if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var o=t.createTextRange(),i=o.duplicate();return o.moveToBookmark(e.getBookmark()),i.setEndPoint("EndToStart",o),i.text.length}return 0},$.prototype.setCaretPosition=function(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange)t.focus(),t.setSelectionRange(e,o);else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",o),i.moveStart("character",e),i.select()}},$.prototype.getScrollbarWidth=function(){return void 0===e&&(e=function(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),(document.body||document.documentElement).appendChild(e);var o=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return o==i&&(i=e.clientWidth),(document.body||document.documentElement).removeChild(e),o-i}()),e}}(),G.prototype.parentCell=function(t){var e={},o=this.instance.wtTable.TABLE,i=this.wtDom.closest(t,["TD","TH"],o);return i&&this.wtDom.isChildOf(i,o)?(e.coords=this.instance.wtTable.getCoords(i),e.TD=i):this.wtDom.hasClass(t,"wtBorder")&&this.wtDom.hasClass(t,"current")&&(e.coords=this.instance.selections.current.selected[0],e.TD=this.instance.wtTable.getCell(e.coords)),e},G.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0),clearTimeout(this.dblClickTimeout1)},e.requestAnimFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,o){return e.setTimeout(t,1e3/60)},e.cancelRequestAnimFrame=e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout,e.getComputedStyle||(N={getPropertyValue:function(t){return"float"==t&&(t="styleFloat"),O.currentStyle[t.toUpperCase()]||null}},e.getComputedStyle=function(t){return O=t,N}),!String.prototype.trim){var X=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(X,"")}}function Y(){}function q(t,e,o){W.apply(this,arguments),this.containerSizeFn=e,this.sizeAtIndex=o,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.remainingSize=-1/0}function Q(t){this.instance=t}function J(){}Y.prototype=new B,Y.prototype.readSettings=function(t){t.cloneOverlay instanceof U?this.offset=0:this.offset=t.wtSettings.settings.offsetRow,this.total=t.getSetting("totalRows"),this.fixedCount=t.getSetting("fixedRowsTop")},q.prototype=new W,q.prototype.add=function(t,e,o){if(!this.isLastIncomplete()&&0!=this.remainingSize){var i=this.sizeAtIndex(t,e);if(void 0===i)return!1;var n=this.getContainerSize(this.cellSizesSum+i);return o?this.cellSizes.unshift(i):this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,this.remainingSize=this.cellSizesSum-n,!o||!this.isLastIncomplete()}return!1},q.prototype.remove=function(){var t=this.cellSizes.pop();this.cellSizesSum-=t,this.cellCount--,this.remainingSize-=t},q.prototype.removeOutstanding=function(){for(;this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize;)this.remove()},Q.prototype.scrollVertical=function(t){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var e,o=this.instance,i=o.getSetting("offsetRow"),n=o.getSetting("fixedRowsTop"),s=o.getSetting("totalRows"),r=o.wtViewport.getViewportHeight();return(e=s>0?this.scrollLogicVertical(t,i,s,n,r,function(t){return t-i<n&&t-i>=0?o.getSetting("rowHeight",t-i):o.getSetting("rowHeight",t)},function(t){o.wtTable.verticalRenderReverse=t}):0)!==i&&this.instance.wtScrollbars.vertical.scrollTo(e),o},Q.prototype.scrollHorizontal=function(t){if(!this.instance.drawn)throw new Error("scrollHorizontal can only be called after table was drawn to DOM");var e,o=this.instance,i=o.getSetting("offsetColumn"),n=o.getSetting("fixedColumnsLeft"),s=o.getSetting("totalColumns"),r=o.wtViewport.getViewportWidth();return(e=s>0?this.scrollLogicHorizontal(t,i,s,n,r,function(t){return t-i<n&&t-i>=0?o.getSetting("columnWidth",t-i):o.getSetting("columnWidth",t)}):0)!==i&&this.instance.wtScrollbars.horizontal.scrollTo(e),o},Q.prototype.scrollLogicVertical=function(t,e,o,i,n,s,r){var a=e+t;return a>=o-i&&(a=o-i-1,r(!0)),a<0&&(a=0),a},Q.prototype.scrollLogicHorizontal=function(t,e,o,i,n,s){var r,a=e+t,l=0;if(a>i){for(a>=o-i&&(a=o-i-1),r=a;l<n&&r<o;)l+=s(r),r++;if(l<n)for(;a>0&&(l+=s(a-1))<n;)a--}else a<0&&(a=0);return a},Q.prototype.scrollViewport=function(t){if(this.instance.drawn){var o=this.instance.getSetting("offsetRow"),i=(this.instance.getSetting("offsetColumn"),this.instance.wtTable.getLastVisibleRow()),n=this.instance.getSetting("totalRows"),s=this.instance.getSetting("totalColumns"),r=this.instance.getSetting("fixedRowsTop"),a=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var l=this.instance.wtTable.getCell(t);if("object"==typeof l){var c=$.prototype.offset(l),h=$.prototype.outerWidth(l),u=$.prototype.outerHeight(l),d=this.instance.wtScrollbars.horizontal.getScrollPosition(),p=this.instance.wtScrollbars.vertical.getScrollPosition(),f=$.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler),g=$.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);return this.instance.wtScrollbars.horizontal.scrollHandler!==e&&(c.left=c.left-$.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==e&&(c.top=c.top-$.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),g-=20,h<(f-=20)&&(c.left<d?this.instance.wtScrollbars.horizontal.setScrollPosition(c.left):c.left+h>d+f&&this.instance.wtScrollbars.horizontal.setScrollPosition(c.left-f+h)),void(u<g&&(c.top<p?this.instance.wtScrollbars.vertical.setScrollPosition(c.top):c.top+u>p+g&&this.instance.wtScrollbars.vertical.setScrollPosition(c.top-g+u)))}}if(t[0]<0||t[0]>n-1)throw new Error("row "+t[0]+" does not exist");if(t[1]<0||t[1]>s-1)throw new Error("column "+t[1]+" does not exist");if(t[0]>i?(this.scrollVertical(t[0]-r-o),this.instance.wtTable.verticalRenderReverse=!0):t[0]===i&&this.instance.wtTable.rowStrategy.isLastIncomplete()?(this.scrollVertical(t[0]-r-o),this.instance.wtTable.verticalRenderReverse=!0):t[0]-r<o?this.scrollVertical(t[0]-r-o):this.scrollVertical(0),this.instance.wtTable.isColumnBeforeViewport(t[1]))this.instance.wtScrollbars.horizontal.scrollTo(t[1]-a);else if(this.instance.wtTable.isColumnAfterViewport(t[1])||this.instance.wtTable.getLastVisibleColumn()===t[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){for(var m=0,w=0;w<a;w++)m+=this.instance.getSetting("columnWidth",w);var y=t[1];m+=this.instance.getSetting("columnWidth",y);var v=this.instance.wtViewport.getViewportWidth();if(m<v)for(var C=this.instance.getSetting("columnWidth",y-1);m+C<=v&&y>=a;)y--,m+=C,C=this.instance.getSetting("columnWidth",y-1);this.instance.wtScrollbars.horizontal.scrollTo(y-a)}return this.instance}},J.prototype.init=function(){var e=this;this.$table=t(this.instance.wtTable.TABLE),this.slider=document.createElement("DIV"),this.sliderStyle=this.slider.style,this.sliderStyle.position="absolute",this.sliderStyle.top="0",this.sliderStyle.left="0",this.sliderStyle.display="none",this.slider.className="dragdealer "+this.type,this.handle=document.createElement("DIV"),this.handleStyle=this.handle.style,this.handle.className="handle",this.slider.appendChild(this.handle),this.container=this.instance.wtTable.holder,this.container.appendChild(this.slider);var o,i=!0;this.dragTimeout=null;var n=function(){e.onScroll(o)};this.dragdealer=new dt(this.slider,{vertical:"vertical"===this.type,horizontal:"horizontal"===this.type,slide:!1,speed:100,animationCallback:function(t,s){i?i=!1:(e.skipRefresh=!0,o="vertical"===e.type?s:t,null===e.dragTimeout&&(e.dragTimeout=setInterval(n,100),n()))},callback:function(t,i){e.skipRefresh=!1,clearInterval(e.dragTimeout),e.dragTimeout=null,o="vertical"===e.type?i:t,e.onScroll(o)}}),this.skipRefresh=!1},J.prototype.onScroll=function(t){if(this.instance.drawn&&(this.readSettings(),this.total>this.visibleCount)){var e=Math.round(this.handlePosition*this.total/this.sliderSize);1===t?"vertical"===this.type?this.instance.scrollVertical(1/0).draw():this.instance.scrollHorizontal(1/0).draw():e!==this.offset?"vertical"===this.type?this.instance.scrollVertical(e-this.offset).draw():this.instance.scrollHorizontal(e-this.offset).draw():this.refresh()}},J.prototype.getHandleSizeRatio=function(t,e){return!e||t>e||t==e?1:1/e},J.prototype.prepare=function(){if(!this.skipRefresh){var t=this.getHandleSizeRatio(this.visibleCount,this.total);(1===t||isNaN(t))&&"auto"===this.scrollMode||"none"===this.scrollMode?this.visible=!1:this.visible=!0}},J.prototype.refresh=function(){if(!this.skipRefresh)if(this.visible){var t,e,o,i,n=this.visibleCount,s=this.instance.wtViewport.getWorkspaceWidth(),r=this.instance.wtViewport.getWorkspaceHeight();s===1/0&&(s=this.instance.wtViewport.getWorkspaceActualWidth()),r===1/0&&(r=this.instance.wtViewport.getWorkspaceActualHeight()),"vertical"===this.type?(this.instance.wtTable.rowStrategy.isLastIncomplete()&&n--,e=r-2,this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px",this.sliderStyle.left=s-1+"px",this.sliderStyle.height=Math.max(e,0)+"px"):(e=s-2,this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px",this.sliderStyle.top=r-1+"px",this.sliderStyle.width=Math.max(e,0)+"px"),t=this.getHandleSizeRatio(n,this.total),(o=Math.round(e*t))<10&&(o=15),o+(i=Math.floor(e*(this.offset/this.total)))>e&&(i=e-o),"vertical"===this.type?(this.handleStyle.height=o+"px",this.handleStyle.top=i+"px"):(this.handleStyle.width=o+"px",this.handleStyle.left=i+"px"),this.sliderStyle.display="block"}else this.sliderStyle.display="none"},J.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var Z=function(t){this.instance=t,this.type="vertical",this.init()};Z.prototype=new J,Z.prototype.scrollTo=function(t){this.instance.update("offsetRow",t)},Z.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV"),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows"),this.visibleCount=this.instance.wtTable.rowStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.top,10),this.sliderSize=parseInt(this.sliderStyle.height,10),this.fixedCount=this.instance.getSetting("fixedRowsTop")};var tt=function(t){this.instance=t,this.type="horizontal",this.init()};function et(t){this.instance=t,this.init(),this.clone=this.makeClone("corner")}function ot(t){this.instance=t,this.type="horizontal",this.cellSize=50,this.init(),this.clone=this.makeClone("left")}function it(t){this.instance=t,this.type="vertical",this.cellSize=23,this.init(),this.clone=this.makeClone("top")}tt.prototype=new J,tt.prototype.scrollTo=function(t){this.instance.update("offsetColumn",t)},tt.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH"),this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns"),this.visibleCount=this.instance.wtTable.columnStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.left,10),this.sliderSize=parseInt(this.sliderStyle.width,10),this.fixedCount=this.instance.getSetting("fixedColumnsLeft")},tt.prototype.getHandleSizeRatio=function(t,e){return!e||t>e||t==e?1:t/e},et.prototype=new I,et.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){t=this.instance.wtTable.hider.getBoundingClientRect();var i=Math.ceil(t.top,10),n=Math.ceil(t.bottom,10);o.style.top=i<0&&n>0?"0":i+"px";var s=Math.ceil(t.left,10),r=Math.ceil(t.right,10);o.style.left=s<0&&r>0?"0":s+"px"}else t=this.scrollHandler.getBoundingClientRect(),o.style.top=Math.ceil(t.top,10)+"px",o.style.left=Math.ceil(t.left,10)+"px";o.style.width=$.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px",o.style.height=$.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},et.prototype.prepare=function(){},et.prototype.refresh=function(t){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(t)},et.prototype.getScrollPosition=function(){},et.prototype.getLastCell=function(){},et.prototype.applyToDOM=function(){},et.prototype.scrollTo=function(){},et.prototype.readWindowSize=function(){},et.prototype.readSettings=function(){},ot.prototype=new I,ot.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){t=this.instance.wtTable.hider.getBoundingClientRect();var i=Math.ceil(t.left,10),n=Math.ceil(t.right,10);o.style.left=i<0&&n>0?"0":i+"px"}else t=this.scrollHandler.getBoundingClientRect(),o.style.top=Math.ceil(t.top,10)+"px",o.style.left=Math.ceil(t.left,10)+"px"}},ot.prototype.react=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode;if(this.instance.wtScrollbars.vertical.scrollHandler===e){var o=this.instance.wtTable.hider.getBoundingClientRect();t.style.top=Math.ceil(o.top,10)+"px",t.style.height=$.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"}else this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px",t.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px";t.style.width=$.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},ot.prototype.prepare=function(){},ot.prototype.refresh=function(t){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(t)},ot.prototype.getScrollPosition=function(){return this.scrollHandler===e?this.scrollHandler.scrollX:this.scrollHandler.scrollLeft},ot.prototype.setScrollPosition=function(t){this.scrollHandler.scrollLeft=t},ot.prototype.onScroll=function(){I.prototype.onScroll.apply(this,arguments),this.instance.getSetting("onScrollHorizontally")},ot.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},ot.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px",this.fixedContainer.style.paddingRight=this.measureAfter+"px"},ot.prototype.scrollTo=function(t){this.$scrollHandler.scrollLeft(this.tableParentOffset+t*this.cellSize)},ot.prototype.readWindowSize=function(){this.scrollHandler===e?(this.windowSize=document.documentElement.clientWidth,this.tableParentOffset=this.instance.wtTable.holderOffset.left):(this.windowSize=$.prototype.outerWidth(this.scrollHandler),this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},ot.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns")},it.prototype=new I,it.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){t=this.instance.wtTable.hider.getBoundingClientRect();var i=Math.ceil(t.top,10),n=Math.ceil(t.bottom,10);o.style.top=i<0&&n>0?"0":i+"px"}else t=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect(),o.style.top=Math.ceil(t.top,10)+"px",o.style.left=Math.ceil(t.left,10)+"px";this.instance.wtScrollbars.horizontal.scrollHandler===e?o.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px":o.style.width=$.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px",o.style.height=$.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},it.prototype.react=function(){this.instance.wtTable.holder.parentNode&&(this.instance.wtScrollbars.horizontal.scrollHandler!==e&&(this.clone.wtTable.holder.parentNode.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"))},it.prototype.getScrollPosition=function(){return this.scrollHandler===e?this.scrollHandler.scrollY:this.scrollHandler.scrollTop},it.prototype.setScrollPosition=function(t){this.scrollHandler.scrollTop=t},it.prototype.onScroll=function(t){var e;I.prototype.onScroll.apply(this,arguments);var o=0;if(e=this.windowScrollPosition-this.tableParentOffset,0,e>0){for(var i=0,n=0;n<this.total&&!((i+=this.instance.getSetting("rowHeight",n))>e);n++);this.offset>0&&i-e,o=n,o=Math.min(o,this.total)}this.curOuts=o>this.maxOuts?this.maxOuts:o,o-=this.curOuts,this.instance.update("offsetRow",o),this.readSettings(),this.instance.draw(),this.instance.getSetting("onScrollVertically")},it.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};function nt(t){this.instance=t,t.getSetting("nativeScrollbars")?(t.update("scrollbarWidth",t.wtDom.getScrollbarWidth()),t.update("scrollbarHeight",t.wtDom.getScrollbarWidth()),this.vertical=new it(t),this.horizontal=new ot(t),this.corner=new et(t),t.getSetting("debug")&&(this.debug=new U(t)),this.registerListeners()):(this.vertical=new Z(t),this.horizontal=new tt(t))}function st(t,e){this.instance=t,this.settings=e,this.selected=[],e.border&&(this.border=new L(t,e))}function rt(t,e){var o=this;this.instance=t,this.defaults={table:void 0,debug:!1,scrollH:"auto",scrollV:"auto",nativeScrollbars:!1,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(t,e,i){var n=o.getSetting("data",t,e);o.instance.wtDom.fastInnerText(i,void 0===n||null===n?"":n)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==e[i])this.settings[i]=e[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function at(t,e){this.instance=t,this.TABLE=e,this.wtDom=this.instance.wtDom,this.wtDom.removeTextNodes(this.TABLE);var o=this.TABLE.parentNode;if(!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",o&&o.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,!(o=this.spreader.parentNode)||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var n=document.createElement("DIV");n.className="wtHider",o&&o.insertBefore(n,this.spreader),n.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",!(o=this.hider.parentNode)||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",o&&o.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var r=document.createElement("TR");this.THEAD.appendChild(r)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.oldCellCache=new _,this.currentCellCache=new _,this.rowFilter=new Y,this.columnFilter=new z,this.verticalRenderReverse=!1}function lt(o){if(this.instance=o,this.resetSettings(),this.instance.getSetting("nativeScrollbars")){var i=this;t(e).on("resize",function(){i.clientHeight=i.getWorkspaceHeight()})}}it.prototype.sumCellSizes=function(t,e){for(var o=0;t<e;)o+=this.instance.getSetting("rowHeight",t),t++;return o},it.prototype.applyToDOM=function(){var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},it.prototype.scrollTo=function(t){var e=this.tableParentOffset+t*this.cellSize;this.$scrollHandler.scrollTop(e),this.onScroll(e)},it.prototype.readWindowSize=function(){this.scrollHandler===e?(this.windowSize=document.documentElement.clientHeight,this.tableParentOffset=this.instance.wtTable.holderOffset.top):(this.windowSize=this.scrollHandler.clientHeight,this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},it.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows")},nt.prototype.registerListeners=function(){var o,i,n,s,r,a,l=this;function c(){l.instance.wtTable.holder.parentNode?(l.vertical.windowScrollPosition=l.vertical.getScrollPosition(),l.horizontal.windowScrollPosition=l.horizontal.getScrollPosition(),l.box=l.instance.wtTable.hider.getBoundingClientRect(),l.box.width===r&&l.box.height===a||!l.instance.rowHeightCache||(r=l.box.width,a=l.box.height,l.instance.draw()),l.vertical.windowScrollPosition===o&&l.horizontal.windowScrollPosition===i&&l.box.top===n&&l.box.left===s||(l.vertical.onScroll(),l.horizontal.onScroll(),l.vertical.react(),l.horizontal.react(),o=l.vertical.windowScrollPosition,i=l.horizontal.windowScrollPosition,n=l.box.top,s=l.box.left)):l.destroy()}var h=t(e);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,c),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,c),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&h.on("scroll."+this.instance.guid,c),h.on("load."+this.instance.guid,c),h.on("resize."+this.instance.guid,c),t(document).on("ready."+this.instance.guid,c),setInterval(c,100)},nt.prototype.destroy=function(){this.vertical&&this.vertical.destroy(),this.horizontal&&this.horizontal.destroy()},nt.prototype.refresh=function(t){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.prepare(),this.vertical&&this.vertical.prepare(),this.horizontal&&this.horizontal.refresh(t),this.vertical&&this.vertical.refresh(t),this.corner&&this.corner.refresh(t),this.debug&&this.debug.refresh(t)},st.prototype.add=function(t){this.selected.push(t)},st.prototype.clear=function(){this.selected.length=0},st.prototype.getCorners=function(){var t,e,o,i,n,s=this.selected.length;if(s>0&&(t=o=this.selected[0][0],e=i=this.selected[0][1],s>1))for(n=1;n<s;n++)this.selected[n][0]<t?t=this.selected[n][0]:this.selected[n][0]>o&&(o=this.selected[n][0]),this.selected[n][1]<e?e=this.selected[n][1]:this.selected[n][1]>i&&(i=this.selected[n][1]);return[t,e,o,i]},st.prototype.draw=function(){var t,e,o,i,n,s=this.instance.wtTable.rowStrategy.countVisible(),r=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){for(t=this.getCorners(),e=0;e<s;e++)for(o=0;o<r;o++)i=this.instance.wtTable.rowFilter.visibleToSource(e),n=this.instance.wtTable.columnFilter.visibleToSource(o),i>=t[0]&&i<=t[2]&&n>=t[1]&&n<=t[3]?this.instance.wtTable.currentCellCache.add(e,o,this.settings.className):i>=t[0]&&i<=t[2]?this.instance.wtTable.currentCellCache.add(e,o,this.settings.highlightRowClassName):n>=t[1]&&n<=t[3]&&this.instance.wtTable.currentCellCache.add(e,o,this.settings.highlightColumnClassName);this.border&&this.border.appear(t)}else this.border&&this.border.disappear()},rt.prototype.update=function(t,e){if(void 0===e)for(var o in t)t.hasOwnProperty(o)&&(this.settings[o]=t[o]);else this.settings[t]=e;return this.instance},rt.prototype.getSetting=function(t,e,o,i){return this[t]?this[t](e,o,i):this._getSetting(t,e,o,i)},rt.prototype._getSetting=function(t,e,o,i){return"function"==typeof this.settings[t]?this.settings[t](e,o,i):void 0!==e&&"[object Array]"===Object.prototype.toString.call(this.settings[t])?this.settings[t][e]:this.settings[t]},rt.prototype.has=function(t){return!!this.settings[t]},rt.prototype.rowHeight=function(t,e){if(this.instance.rowHeightCache||(this.instance.rowHeightCache=[]),void 0===this.instance.rowHeightCache[t]){var o=23;return e&&(o=this.instance.wtDom.outerHeight(e),this.instance.rowHeightCache[t]=o),o}return this.instance.rowHeightCache[t]},at.prototype.refreshHiderDimensions=function(){var t=this.instance.wtViewport.getWorkspaceHeight(),e=this.instance.wtViewport.getWorkspaceWidth(),o=this.spreader.style;t===1/0&&e===1/0||this.instance.getSetting("nativeScrollbars")?(o.position="relative",o.width="auto",o.height="auto"):(t===1/0&&(t=this.instance.wtViewport.getWorkspaceActualHeight()),e===1/0&&(e=this.instance.wtViewport.getWorkspaceActualWidth()),this.hiderStyle.overflow="hidden",o.position="absolute",o.top="0",o.left="0",this.instance.getSetting("nativeScrollbars")||(o.height="4000px",o.width="4000px"),t<0&&(t=0),this.hiderStyle.height=t+"px",this.hiderStyle.width=e+"px")},at.prototype.refreshStretching=function(){if(!this.instance.cloneSource){var t=this.instance,e=t.getSetting("stretchH"),o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),n=t.getSetting("offsetColumn"),s=this;"hybrid"===e&&(e=n>0?"last":"none");this.columnStrategy=new F(t,function(t){var e=s.instance.wtViewport.getViewportWidth(t);return e<t&&s.instance.getSetting("nativeScrollbars")?1/0:e},function(e){var o=s.columnFilter.visibleToSource(e);if(o<i)return t.getSetting("columnWidth",o)},e),this.rowStrategy=new q(t,function(t){return s.instance.getSetting("nativeScrollbars")?s.instance.cloneOverlay instanceof U?1/0:2*s.instance.wtViewport.getViewportHeight(t):s.instance.wtViewport.getViewportHeight(t)},function(t,e){if(s.instance.getSetting("nativeScrollbars"))return 20;var i=s.rowFilter.visibleToSource(t);return i<o?s.verticalRenderReverse&&0===t?s.instance.getSetting("rowHeight",i,e)-1:s.instance.getSetting("rowHeight",i,e):void 0})}},at.prototype.adjustAvailableNodes=function(){for(var t,e,o,i,n=this.instance.getSetting("rowHeaders"),s=n.length,r=this.instance.getSetting("columnHeaders");this.colgroupChildrenLength<s;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(this.refreshStretching(),t=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof ot||this.instance.cloneOverlay instanceof et)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount;this.colgroupChildrenLength<t+s;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(;this.colgroupChildrenLength>t+s;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.colgroupChildrenLength--;if(e=this.THEAD.firstChild,r.length){for(e||(e=document.createElement("TR"),this.THEAD.appendChild(e)),this.theadChildrenLength=e.childNodes.length;this.theadChildrenLength<t+s;)e.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>t+s;)e.removeChild(e.lastChild),this.theadChildrenLength--}else e&&this.wtDom.empty(e);for(i=0;i<this.colgroupChildrenLength;i++)i<s?this.wtDom.addClass(this.COLGROUP.childNodes[i],"rowHeader"):this.wtDom.removeClass(this.COLGROUP.childNodes[i],"rowHeader");if(r.length&&(e=this.THEAD.firstChild,s))for(o=e.firstChild,i=0;i<s;i++)n[i](-s+i,o),o=o.nextSibling;for(i=0;i<t;i++)r.length&&r[0](this.columnFilter.visibleToSource(i),e.childNodes[s+i])},at.prototype.adjustColumns=function(t,e){for(var o=t.childNodes.length;o<e;){var i=document.createElement("TD");t.appendChild(i),o++}for(;o>e;)t.removeChild(t.lastChild),o--},at.prototype.draw=function(t){return this.instance.getSetting("nativeScrollbars")&&(this.verticalRenderReverse=!1),this.rowFilter.readSettings(this.instance),this.columnFilter.readSettings(this.instance),t?this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0):(this.instance.getSetting("nativeScrollbars")?this.instance.cloneSource?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=this.wtDom.offset(this.holder),this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readWindowSize(),this.instance.wtScrollbars.horizontal.readWindowSize(),this.instance.wtViewport.resetSettings()):(this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtViewport.resetSettings()),this._doDraw()),this.refreshPositions(t),t||this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition())),this.instance.drawn=!0,this},at.prototype._doDraw=function(){var t,e,o,i,n,s,r,a,l,c=0,h=this.instance.getSetting("offsetRow"),u=this.instance.getSetting("totalRows"),d=this.instance.getSetting("totalColumns"),p=this.instance.getSetting("rowHeaders"),f=p.length,g=!1;this.verticalRenderReverse&&(l=h);var m=!1;if(this.verticalRenderReverse&&(h===u-this.rowFilter.fixedCount-1?m=!0:(this.instance.update("offsetRow",h+1),this.rowFilter.readSettings(this.instance))),this.instance.cloneSource&&(this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy,this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy),d>0){t=this.rowFilter.visibleToSource(c);var w,y=this.instance.getSetting("fixedRowsTop");for(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof it||this.instance.cloneOverlay instanceof et?w=y:this.instance.cloneOverlay instanceof ot&&(w=this.rowStrategy.countVisible())),this.adjustAvailableNodes(),g=!0,i=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof ot||this.instance.cloneOverlay instanceof et)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount,this.instance.cloneSource||(a=this.instance.wtViewport.getWorkspaceWidth(),this.columnStrategy.stretch()),e=0;e<i;e++)this.COLGROUP.childNodes[e+f].style.width=this.columnStrategy.getSize(e)+"px";for(;t<u&&t>=0;){if(c>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==w&&c===w)break;if(c>=this.tbodyChildrenLength||this.verticalRenderReverse&&c>=this.rowFilter.fixedCount){for(n=document.createElement("TR"),e=0;e<f;e++)n.appendChild(document.createElement("TH"));this.verticalRenderReverse&&c>=this.rowFilter.fixedCount?this.TBODY.insertBefore(n,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild):this.TBODY.appendChild(n),this.tbodyChildrenLength++}else n=0===c?this.TBODY.firstChild:n.nextSibling;for(r=n.firstChild,e=0;e<f;e++)"TD"==r.nodeName&&(s=r,r=document.createElement("TH"),n.insertBefore(r,s),n.removeChild(s)),p[e](t,r),r=r.nextSibling;for(this.adjustColumns(n,i+f),e=0;e<i;e++)o=this.columnFilter.visibleToSource(e),"TH"==(s=0===e?n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]:s.nextSibling).nodeName&&(r=s,s=document.createElement("TD"),n.insertBefore(s,r),n.removeChild(r)),s.className="",s.removeAttribute("style"),this.instance.getSetting("cellRenderer",t,o,s);if(h=this.instance.getSetting("offsetRow"),this.verticalRenderReverse&&m){if(-this.wtDom.outerHeight(n.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(n),this.instance.update("offsetRow",h+1),this.tbodyChildrenLength--,this.rowFilter.readSettings(this.instance);break}this.instance.cloneSource||!1===this.rowStrategy.add(c,s,this.verticalRenderReverse)&&this.rowStrategy.removeOutstanding()}else if(!this.instance.cloneSource&&(!1===this.rowStrategy.add(c,s,this.verticalRenderReverse)&&(this.instance.getSetting("nativeScrollbars")||this.rowStrategy.removeOutstanding()),this.rowStrategy.isLastIncomplete())){if(this.verticalRenderReverse&&!this.isRowInViewport(l))return this.verticalRenderReverse=!1,this.instance.update("offsetRow",l),void this.draw();break}if(this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource?n.style.height=this.instance.getSetting("rowHeight",t)+"px":this.instance.getSetting("rowHeight",t,s)),this.verticalRenderReverse&&c>=this.rowFilter.fixedCount){if(0===h)break;this.instance.update("offsetRow",h-1),this.rowFilter.readSettings(this.instance)}else c++;t=this.rowFilter.visibleToSource(c)}}if(g||this.adjustAvailableNodes(),!(this.instance.cloneOverlay instanceof U))for(c=this.rowStrategy.countVisible();this.tbodyChildrenLength>c;)this.TBODY.removeChild(this.TBODY.lastChild),this.tbodyChildrenLength--;if(this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!1),!this.instance.cloneSource&&a!==this.instance.wtViewport.getWorkspaceWidth())for(this.columnStrategy.stretch(),e=0;e<this.columnStrategy.cellCount;e++)this.COLGROUP.childNodes[e+f].style.width=this.columnStrategy.getSize(e)+"px";this.verticalRenderReverse=!1},at.prototype.refreshPositions=function(t){this.refreshHiderDimensions(),this.refreshSelections(t)},at.prototype.refreshSelections=function(t){var e,o,i,n,s,r,a=[],l=this.rowStrategy.countVisible(),c=this.columnStrategy.countVisible();if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new _,this.instance.selections)for(o in this.instance.selections)this.instance.selections.hasOwnProperty(o)&&(this.instance.selections[o].draw(),this.instance.selections[o].settings.className&&a.push(this.instance.selections[o].settings.className),this.instance.selections[o].settings.highlightRowClassName&&a.push(this.instance.selections[o].settings.highlightRowClassName),this.instance.selections[o].settings.highlightColumnClassName&&a.push(this.instance.selections[o].settings.highlightColumnClassName));for(r=a.length,e=0;e<l;e++)for(i=0;i<c;i++)for(o=this.rowFilter.visibleToSource(e),n=this.columnFilter.visibleToSource(i),s=0;s<r;s++)this.currentCellCache.test(e,i,a[s])?this.wtDom.addClass(this.getCell([o,n]),a[s]):t&&this.oldCellCache.test(e,i,a[s])&&this.wtDom.removeClass(this.getCell([o,n]),a[s])},at.prototype.getCell=function(t){return this.isRowBeforeViewport(t[0])?-1:this.isRowAfterViewport(t[0])?-2:this.isColumnBeforeViewport(t[1])?-3:this.isColumnAfterViewport(t[1])?-4:this.TBODY.childNodes[this.rowFilter.sourceToVisible(t[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t[1])]},at.prototype.getCoords=function(t){return[this.rowFilter.visibleToSource(this.wtDom.index(t.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(t.cellIndex)]},at.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)},at.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)},at.prototype.isRowBeforeViewport=function(t){return this.rowFilter.sourceToVisible(t)<this.rowFilter.fixedCount&&t>=this.rowFilter.fixedCount},at.prototype.isRowAfterViewport=function(t){return t>this.getLastVisibleRow()},at.prototype.isColumnBeforeViewport=function(t){return this.columnFilter.sourceToVisible(t)<this.columnFilter.fixedCount&&t>=this.columnFilter.fixedCount},at.prototype.isColumnAfterViewport=function(t){return t>this.getLastVisibleColumn()},at.prototype.isRowInViewport=function(t){return!this.isRowBeforeViewport(t)&&!this.isRowAfterViewport(t)},at.prototype.isColumnInViewport=function(t){return!this.isColumnBeforeViewport(t)&&!this.isColumnAfterViewport(t)},at.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()},at.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()},lt.prototype.getWorkspaceHeight=function(t){if(this.instance.getSetting("nativeScrollbars"))return this.instance.wtScrollbars.vertical.windowSize;var e=this.instance.getSetting("height");return(e===1/0||void 0===e||null===e||e<1)&&(e=this.instance.wtScrollbars.vertical instanceof I?this.instance.wtScrollbars.vertical.availableSize():1/0),e!==1/0&&(t>=e?e-=this.instance.getSetting("scrollbarHeight"):this.instance.wtScrollbars.horizontal.visible&&(e-=this.instance.getSetting("scrollbarHeight"))),e},lt.prototype.getWorkspaceWidth=function(t){var e=this.instance.getSetting("width");return(e===1/0||void 0===e||null===e||e<1)&&(e=this.instance.wtScrollbars.horizontal instanceof I?this.instance.wtScrollbars.horizontal.availableSize():1/0),e!==1/0&&(t>=e?e-=this.instance.getSetting("scrollbarWidth"):this.instance.wtScrollbars.vertical.visible&&(e-=this.instance.getSetting("scrollbarWidth"))),e},lt.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)},lt.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)},lt.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var t=this.instance.wtDom.offset(this.instance.wtTable.TBODY),e=this.instance.wtTable.tableOffset;this.columnHeaderHeight=t.top-e.top}return this.columnHeaderHeight},lt.prototype.getViewportHeight=function(t){var e=this.getWorkspaceHeight(t);if(e===1/0)return e;var o=this.getColumnHeaderHeight();return o>0?e-o:e},lt.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var t=this.instance.getSetting("rowHeaders");if(t.length){var e=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var o=0,i=t.length;o<i;o++)e?(this.rowHeaderWidth+=this.instance.wtDom.outerWidth(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},lt.prototype.getViewportWidth=function(t){var e=this.getWorkspaceWidth(t);if(e===1/0)return e;var o=this.getRowHeaderWidth();return o>0?e-o:e},lt.prototype.resetSettings=function(){this.rowHeaderWidth=NaN,this.columnHeaderHeight=NaN};var ct={x:0,y:0,init:function(){this.setEvent("mouse"),this.setEvent("touch")},setEvent:function(t){var e=document["on"+t+"move"]||function(){};document["on"+t+"move"]=function(t){e(t),ct.refresh(t)}},refresh:function(t){t||(t=e.event),"mousemove"==t.type?this.set(t):t.touches&&this.set(t.touches[0])},set:function(t){t.pageX||t.pageY?(this.x=t.pageX,this.y=t.pageY):document.body&&(t.clientX||t.clientY)&&(this.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop)}};ct.init();var ht,ut=function(t){var e=0,o=0;if(t.offsetParent)do{o+=t.offsetLeft,e+=t.offsetTop}while(t=t.offsetParent);return[o,e]},dt=function(t,e){if("string"==typeof t&&(t=document.getElementById(t)),t){var o=t.getElementsByTagName("div")[0];o&&-1!=o.className.search(/(^|\s)handle(\s|$)/)&&(this.init(t,o,e||{}),this.setup())}};dt.prototype={init:function(t,e,o){this.wrapper=t,this.handle=e,this.options=o,this.disabled=this.getOption("disabled",!1),this.horizontal=this.getOption("horizontal",!0),this.vertical=this.getOption("vertical",!1),this.slide=this.getOption("slide",!0),this.steps=this.getOption("steps",0),this.snap=this.getOption("snap",!1),this.loose=this.getOption("loose",!1),this.speed=this.getOption("speed",10)/100,this.xPrecision=this.getOption("xPrecision",0),this.yPrecision=this.getOption("yPrecision",0),this.callback=o.callback||null,this.animationCallback=o.animationCallback||null,this.bounds={left:o.left||0,right:-(o.right||0),top:o.top||0,bottom:-(o.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0},this.value={prev:[-1,-1],current:[o.x||0,o.y||0],target:[o.x||0,o.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.activity=!1,this.dragging=!1,this.tapping=!1},getOption:function(t,e){return void 0!==this.options[t]?this.options[t]:e},setup:function(){this.setWrapperOffset(),this.setBoundsPadding(),this.setBounds(),this.setSteps(),this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=ut(this.wrapper)},setBoundsPadding:function(){this.bounds.left||this.bounds.right||(this.bounds.left=ut(this.handle)[0]-this.offset.wrapper[0],this.bounds.right=-this.bounds.left),this.bounds.top||this.bounds.bottom||(this.bounds.top=ut(this.handle)[1]-this.offset.wrapper[1],this.bounds.bottom=-this.bounds.top)},setBounds:function(){this.bounds.x0=this.bounds.left,this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right,this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth,this.bounds.y0=this.bounds.top,this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom,this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight,this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth)),this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var t=0;t<=this.steps-1;t++)this.stepRatios[t]=t/(this.steps-1)}},addListeners:function(){var t=this;this.wrapper.onselectstart=function(){return!1},this.handle.onmousedown=this.handle.ontouchstart=function(e){t.handleDownHandler(e)},this.wrapper.onmousedown=this.wrapper.ontouchstart=function(e){t.wrapperDownHandler(e)};var o=document.onmouseup||function(){};document.onmouseup=function(e){o(e),t.documentUpHandler(e)};var i=document.ontouchend||function(){};document.ontouchend=function(e){i(e),t.documentUpHandler(e)};var n=e.onresize||function(){};e.onresize=function(e){n(e),t.documentResizeHandler(e)},this.wrapper.onmousemove=function(e){t.activity=!0},this.wrapper.onclick=function(e){return!t.activity},this.interval=setInterval(function(){t.animate()},25),t.animate(!1,!0)},handleDownHandler:function(t){this.activity=!1,ct.refresh(t),this.preventDefaults(t,!0),this.startDrag()},wrapperDownHandler:function(t){ct.refresh(t),this.preventDefaults(t,!0),this.startTap()},documentUpHandler:function(t){this.stopDrag(),this.stopTap()},documentResizeHandler:function(t){this.setWrapperOffset(),this.setBounds(),this.update()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},setStep:function(t,e,o){this.setValue(this.steps&&t>1?(t-1)/(this.steps-1):0,this.steps&&e>1?(e-1)/(this.steps-1):0,o)},setValue:function(t,e,o){this.setTargetValue([t,e||0]),o&&this.groupCopy(this.value.current,this.value.target)},startTap:function(t){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setBounds(),void 0===t&&(t=[ct.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,ct.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]),this.setTargetOffset(t))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current),this.result())},startDrag:function(){this.disabled||(this.setWrapperOffset(),this.setBounds(),this.offset.mouse=[ct.x-ut(this.handle)[0],ct.y-ut(this.handle)[1]],this.dragging=!0)},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var t=this.groupClone(this.value.current);if(this.slide){var e=this.change;t[0]+=4*e[0],t[1]+=4*e[1]}this.setTargetValue(t),this.result()}},feedback:function(){var t=this.value.current;this.snap&&this.steps>1&&(t=this.getClosestSteps(t)),this.groupCompare(t,this.value.prev)||("function"==typeof this.animationCallback&&this.animationCallback(t[0],t[1]),this.groupCopy(this.value.prev,t))},result:function(){"function"==typeof this.callback&&this.callback(this.value.target[0],this.value.target[1])},animate:function(t,e){if(!t||this.dragging){if(this.dragging){var o=this.groupClone(this.value.target),i=[ct.x-this.offset.wrapper[0]-this.offset.mouse[0],ct.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(i,this.loose),this.change=[this.value.target[0]-o[0],this.value.target[1]-o[1]]}(this.dragging||e)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||e)&&(this.update(),this.feedback())}},glide:function(){var t=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return!(!t[0]&&!t[1])&&(Math.abs(t[0])>this.bounds.xStep||Math.abs(t[1])>this.bounds.yStep?(this.value.current[0]+=t[0]*this.speed,this.value.current[1]+=t[1]*this.speed):this.groupCopy(this.value.current,this.value.target),!0)},update:function(){this.snap?this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.offset.current=this.getOffsetsByRatios(this.value.current),this.show()},show:function(){this.groupCompare(this.offset.current,this.offset.prev)||(this.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px"),this.groupCopy(this.offset.prev,this.offset.current))},setTargetValue:function(t,e){var o=e?this.getLooseValue(t):this.getProperValue(t);this.groupCopy(this.value.target,o),this.offset.target=this.getOffsetsByRatios(o)},setTargetOffset:function(t,e){var o=this.getRatiosByOffsets(t),i=e?this.getLooseValue(o):this.getProperValue(o);this.groupCopy(this.value.target,i),this.offset.target=this.getOffsetsByRatios(i)},getLooseValue:function(t){var e=this.getProperValue(t);return[e[0]+(t[0]-e[0])/4,e[1]+(t[1]-e[1])/4]},getProperValue:function(t){var e=this.groupClone(t);return e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0),e[0]=Math.min(e[0],1),e[1]=Math.min(e[1],1),(!this.dragging&&!this.tapping||this.snap)&&this.steps>1&&(e=this.getClosestSteps(e)),e},getRatiosByOffsets:function(t){return[this.getRatioByOffset(t[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(t[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(t,e,o){return e?(t-o)/e:0},getOffsetsByRatios:function(t){return[this.getOffsetByRatio(t[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(t[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(t,e,o){return Math.round(t*e)+o},getClosestSteps:function(t){return[this.getClosestStep(t[0]),this.getClosestStep(t[1])]},getClosestStep:function(t){for(var e=0,o=1,i=0;i<=this.steps-1;i++)Math.abs(this.stepRatios[i]-t)<o&&(o=Math.abs(this.stepRatios[i]-t),e=i);return this.stepRatios[e]},groupCompare:function(t,e){return t[0]==e[0]&&t[1]==e[1]},groupCopy:function(t,e){t[0]=e[0],t[1]=e[1]},groupClone:function(t){return[t[0],t[1]]},preventDefaults:function(t,o){t||(t=e.event),t.preventDefault&&t.preventDefault(),t.returnValue=!1,o&&document.selection&&document.selection.empty()},cancelEvent:function(t){t||(t=e.event),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0}},ht=function(t){var o,i,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(t.event.fixHooks)for(var r=n.length;r;)t.event.fixHooks[n[--r]]=t.event.mouseHooks;function a(n){var s,r,a,l=n||e.event,c=[].slice.call(arguments,1),h=0,u=0,d=0;return(n=t.event.fix(l)).type="mousewheel",l.wheelDelta&&(h=l.wheelDelta),l.detail&&(h=-1*l.detail),l.deltaY&&(h=d=-1*l.deltaY),l.deltaX&&(h=-1*(u=l.deltaX)),void 0!==l.wheelDeltaY&&(d=l.wheelDeltaY),void 0!==l.wheelDeltaX&&(u=-1*l.wheelDeltaX),s=Math.abs(h),(!o||s<o)&&(o=s),r=Math.max(Math.abs(d),Math.abs(u)),(!i||r<i)&&(i=r),a=h>0?"floor":"ceil",h=Math[a](h/o),u=Math[a](u/i),d=Math[a](d/i),c.unshift(n,h,u,d),(t.event.dispatch||t.event.handle).apply(this,c)}t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=s.length;t;)this.addEventListener(s[--t],a,!1);else this.onmousewheel=a},teardown:function(){if(this.removeEventListener)for(var t=s.length;t;)this.removeEventListener(s[--t],a,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})},"function"==typeof define&&define.amd?define(["jquery"],ht):"object"==typeof exports?module.exports=ht:ht(jQuery)}(jQuery,window,Handsontable),function(){var t,e={},o="en",i=null,n="undefined"!=typeof module&&module.exports;function s(t){this._n=t}function r(t,e,o){var i,n=Math.pow(10,e);if(i=(Math.round(t*n)/n).toFixed(e),o){var s=new RegExp("0{1,"+o+"}$");i=i.replace(s,"")}return i}function a(t,n){var s,l,c,h,u;return n.indexOf("$")>-1?s=function(t,i){var n=i.indexOf("$")<=1,s="";i.indexOf(" $")>-1?(s=" ",i=i.replace(" $","")):i.indexOf("$ ")>-1?(s=" ",i=i.replace("$ ","")):i=i.replace("$","");var r=a(t,i);n?r.indexOf("(")>-1||r.indexOf("-")>-1?((r=r.split("")).splice(1,0,e[o].currency.symbol+s),r=r.join("")):r=e[o].currency.symbol+s+r:r.indexOf(")")>-1?((r=r.split("")).splice(-1,0,s+e[o].currency.symbol),r=r.join("")):r=r+s+e[o].currency.symbol;return r}(t,n):n.indexOf("%")>-1?s=function(t,e){var o="";e.indexOf(" %")>-1?(o=" ",e=e.replace(" %","")):e=e.replace("%","");t._n=100*t._n;var i=a(t,e);i.indexOf(")")>-1?((i=i.split("")).splice(-1,0,o+"%"),i=i.join("")):i=i+o+"%";return i}(t,n):n.indexOf(":")>-1?(l=t,c=Math.floor(l._n/60/60),h=Math.floor((l._n-60*c*60)/60),u=Math.round(l._n-60*c*60-60*h),s=c+":"+(h<10?"0"+h:h)+":"+(u<10?"0"+u:u)):s=function(t,n){var s=!1,a=!1,l="",c="",h="",u=Math.abs(t._n);{if(0===t._n&&null!==i)return i;if(n.indexOf("(")>-1&&(s=!0,n=n.slice(1,-1)),n.indexOf("a")>-1&&(n.indexOf(" a")>-1?(l=" ",n=n.replace(" a","")):n=n.replace("a",""),u>=Math.pow(10,12)?(l+=e[o].abbreviations.trillion,t._n=t._n/Math.pow(10,12)):u<Math.pow(10,12)&&u>=Math.pow(10,9)?(l+=e[o].abbreviations.billion,t._n=t._n/Math.pow(10,9)):u<Math.pow(10,9)&&u>=Math.pow(10,6)?(l+=e[o].abbreviations.million,t._n=t._n/Math.pow(10,6)):u<Math.pow(10,6)&&u>=Math.pow(10,3)&&(l+=e[o].abbreviations.thousand,t._n=t._n/Math.pow(10,3))),n.indexOf("b")>-1){n.indexOf(" b")>-1?(c=" ",n=n.replace(" b","")):n=n.replace("b","");for(var d,p,f=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],g=0;g<=f.length;g++)if(d=Math.pow(1024,g),p=Math.pow(1024,g+1),t._n>=d&&t._n<p){c+=f[g],d>0&&(t._n=t._n/d);break}}n.indexOf("o")>-1&&(n.indexOf(" o")>-1?(h=" ",n=n.replace(" o","")):n=n.replace("o",""),h+=e[o].ordinal(t._n)),n.indexOf("[.]")>-1&&(a=!0,n=n.replace("[.]","."));var m=t._n.toString().split(".")[0],w=n.split(".")[1],y=n.indexOf(","),v="",C=!1;return w?(w.indexOf("[")>-1?(w=(w=w.replace("]","")).split("["),v=r(t._n,w[0].length+w[1].length,w[1].length)):v=r(t._n,w.length),m=v.split(".")[0],v=v.split(".")[1].length?e[o].delimiters.decimal+v.split(".")[1]:"",a&&0===Number(v)&&(v="")):m=r(t._n,null),m.indexOf("-")>-1&&(m=m.slice(1),C=!0),y>-1&&(m=m.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+e[o].delimiters.thousands)),0===n.indexOf(".")&&(m=""),(s&&C?"(":"")+(!s&&C?"-":"")+m+v+(h||"")+(l||"")+(c||"")+(s&&C?")":"")}}(t,n),s}function l(t,n){if(n.indexOf(":")>-1)t._n=function(t){var e=t.split(":"),o=0;3===e.length?(o+=60*Number(e[0])*60,o+=60*Number(e[1]),o+=Number(e[2])):2===e.lenght&&(o+=60*Number(e[0]),o+=Number(e[1]));return Number(o)}(n);else if(n===i)t._n=0;else{var s=n;"."!==e[o].delimiters.decimal&&(n=n.replace(/\./g,"").replace(e[o].delimiters.decimal,"."));for(var r=new RegExp(e[o].abbreviations.thousand+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),a=new RegExp(e[o].abbreviations.million+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),l=new RegExp(e[o].abbreviations.billion+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),c=new RegExp(e[o].abbreviations.trillion+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),h=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=!1,d=0;d<=h.length&&!(u=n.indexOf(h[d])>-1&&Math.pow(1024,d+1));d++);t._n=(u||1)*(s.match(r)?Math.pow(10,3):1)*(s.match(a)?Math.pow(10,6):1)*(s.match(l)?Math.pow(10,9):1)*(s.match(c)?Math.pow(10,12):1)*(n.indexOf("%")>-1?.01:1)*Number((n.indexOf("(")>-1?"-":"")+n.replace(/[^0-9\.-]+/g,"")),t._n=u?Math.ceil(t._n):t._n}return t._n}(t=function(e){return t.isNumeral(e)?e=e.value():Number(e)||(e=0),new s(Number(e))}).version="1.4.7",t.isNumeral=function(t){return t instanceof s},t.language=function(i,n){return i?(i&&!n&&(o=i),!n&&e[i]||(s=n,e[i]=s),t):o;var s},t.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),t.zeroFormat=function(t){i="string"==typeof t?t:null},t.fn=s.prototype={clone:function(){return t(this)},format:function(e){return a(this,e||t.defaultFormat)},unformat:function(e){return l(this,e||t.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(t){return this._n=Number(t),this},add:function(t){return this._n=this._n+Number(t),this},subtract:function(t){return this._n=this._n-Number(t),this},multiply:function(t){return this._n=this._n*Number(t),this},divide:function(t){return this._n=this._n/Number(t),this},difference:function(t){var e=this._n-Number(t);return e<0&&(e=-e),e}},n&&(module.exports=t),"undefined"==typeof ender&&(this.numeral=t),"function"==typeof define&&define.amd&&define([],function(){return t})}.call(this);